nohup: ignoring input
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Classes:2
cuda
Epoch 0/99
----------
train Loss: 0.7860 Acc: 0.4219
test Loss: 0.7571 Acc: 0.4370

Epoch 1/99
----------
train Loss: 0.7407 Acc: 0.4346
test Loss: 0.7050 Acc: 0.4874

Epoch 2/99
----------
train Loss: 0.7058 Acc: 0.5063
test Loss: 0.6736 Acc: 0.5882

Epoch 3/99
----------
train Loss: 0.6822 Acc: 0.5401
test Loss: 0.6632 Acc: 0.5714

Epoch 4/99
----------
train Loss: 0.6641 Acc: 0.6034
test Loss: 0.6553 Acc: 0.6134

Epoch 5/99
----------
train Loss: 0.6640 Acc: 0.5823
test Loss: 0.6509 Acc: 0.6050

Epoch 6/99
----------
train Loss: 0.6619 Acc: 0.6160
test Loss: 0.6480 Acc: 0.6218

Epoch 7/99
----------
train Loss: 0.6513 Acc: 0.6076
test Loss: 0.6449 Acc: 0.6134

Epoch 8/99
----------
train Loss: 0.6433 Acc: 0.6160
test Loss: 0.6417 Acc: 0.6134

Epoch 9/99
----------
train Loss: 0.6401 Acc: 0.6456
test Loss: 0.6397 Acc: 0.6134

Epoch 10/99
----------
train Loss: 0.6390 Acc: 0.6160
test Loss: 0.6373 Acc: 0.6387

Epoch 11/99
----------
train Loss: 0.6388 Acc: 0.6287
test Loss: 0.6353 Acc: 0.6387

Epoch 12/99
----------
train Loss: 0.6322 Acc: 0.6582
test Loss: 0.6339 Acc: 0.6218

Epoch 13/99
----------
train Loss: 0.6292 Acc: 0.6624
test Loss: 0.6309 Acc: 0.6387

Epoch 14/99
----------
train Loss: 0.6344 Acc: 0.6414
test Loss: 0.6287 Acc: 0.6471

Epoch 15/99
----------
train Loss: 0.6252 Acc: 0.6751
test Loss: 0.6265 Acc: 0.6471

Epoch 16/99
----------
train Loss: 0.6149 Acc: 0.6751
test Loss: 0.6240 Acc: 0.6639

Epoch 17/99
----------
train Loss: 0.6165 Acc: 0.7089
test Loss: 0.6215 Acc: 0.6639

Epoch 18/99
----------
train Loss: 0.6202 Acc: 0.6835
test Loss: 0.6202 Acc: 0.6723

Epoch 19/99
----------
train Loss: 0.6177 Acc: 0.6709
test Loss: 0.6189 Acc: 0.6387

Epoch 20/99
----------
train Loss: 0.6189 Acc: 0.6709
test Loss: 0.6150 Acc: 0.6639

Epoch 21/99
----------
train Loss: 0.6081 Acc: 0.7215
test Loss: 0.6151 Acc: 0.6471

Epoch 22/99
----------
train Loss: 0.6196 Acc: 0.6624
test Loss: 0.6129 Acc: 0.6639

Epoch 23/99
----------
train Loss: 0.6048 Acc: 0.7089
test Loss: 0.6116 Acc: 0.6723

Epoch 24/99
----------
train Loss: 0.5987 Acc: 0.7089
test Loss: 0.6108 Acc: 0.6639

Epoch 25/99
----------
train Loss: 0.6028 Acc: 0.7046
test Loss: 0.6083 Acc: 0.6723

Epoch 26/99
----------
train Loss: 0.5930 Acc: 0.7004
test Loss: 0.6055 Acc: 0.6807

Epoch 27/99
----------
train Loss: 0.5888 Acc: 0.7131
test Loss: 0.6035 Acc: 0.6891

Epoch 28/99
----------
train Loss: 0.5835 Acc: 0.7342
test Loss: 0.6015 Acc: 0.6807

Epoch 29/99
----------
train Loss: 0.5886 Acc: 0.7215
test Loss: 0.6002 Acc: 0.6807

Epoch 30/99
----------
train Loss: 0.5808 Acc: 0.7257
test Loss: 0.5991 Acc: 0.6891

Epoch 31/99
----------
train Loss: 0.5817 Acc: 0.7046
test Loss: 0.5972 Acc: 0.6891

Epoch 32/99
----------
train Loss: 0.5824 Acc: 0.7426
test Loss: 0.5960 Acc: 0.7059

Epoch 33/99
----------
train Loss: 0.5771 Acc: 0.7384
test Loss: 0.5930 Acc: 0.6975

Epoch 34/99
----------
train Loss: 0.5866 Acc: 0.7089
test Loss: 0.5925 Acc: 0.6891

Epoch 35/99
----------
train Loss: 0.5689 Acc: 0.7595
test Loss: 0.5884 Acc: 0.7059

Epoch 36/99
----------
train Loss: 0.5763 Acc: 0.7131
test Loss: 0.5890 Acc: 0.6975

Epoch 37/99
----------
train Loss: 0.5647 Acc: 0.7595
test Loss: 0.5874 Acc: 0.6975

Epoch 38/99
----------
train Loss: 0.5660 Acc: 0.7553
test Loss: 0.5862 Acc: 0.6807

Epoch 39/99
----------
train Loss: 0.5714 Acc: 0.7300
test Loss: 0.5839 Acc: 0.7059

Epoch 40/99
----------
train Loss: 0.5722 Acc: 0.7468
test Loss: 0.5843 Acc: 0.6975

Epoch 41/99
----------
train Loss: 0.5778 Acc: 0.7384
test Loss: 0.5817 Acc: 0.7059

Epoch 42/99
----------
train Loss: 0.5728 Acc: 0.7300
test Loss: 0.5793 Acc: 0.7059

Epoch 43/99
----------
train Loss: 0.5560 Acc: 0.7468
test Loss: 0.5765 Acc: 0.7143

Epoch 44/99
----------
train Loss: 0.5565 Acc: 0.7679
test Loss: 0.5766 Acc: 0.7143

Epoch 45/99
----------
train Loss: 0.5522 Acc: 0.7679
test Loss: 0.5743 Acc: 0.7143

Epoch 46/99
----------
train Loss: 0.5528 Acc: 0.7637
test Loss: 0.5741 Acc: 0.7143

Epoch 47/99
----------
train Loss: 0.5495 Acc: 0.7764
test Loss: 0.5729 Acc: 0.7143

Epoch 48/99
----------
train Loss: 0.5374 Acc: 0.7890
test Loss: 0.5703 Acc: 0.7059

Epoch 49/99
----------
train Loss: 0.5419 Acc: 0.7637
test Loss: 0.5685 Acc: 0.7227

Epoch 50/99
----------
train Loss: 0.5393 Acc: 0.7848
test Loss: 0.5665 Acc: 0.7227

Epoch 51/99
----------
train Loss: 0.5440 Acc: 0.7595
test Loss: 0.5642 Acc: 0.7227

Epoch 52/99
----------
train Loss: 0.5481 Acc: 0.7511
test Loss: 0.5646 Acc: 0.7227

Epoch 53/99
----------
train Loss: 0.5305 Acc: 0.7932
test Loss: 0.5634 Acc: 0.7143

Epoch 54/99
----------
train Loss: 0.5552 Acc: 0.7384
test Loss: 0.5603 Acc: 0.7227

Epoch 55/99
----------
train Loss: 0.5540 Acc: 0.7595
test Loss: 0.5606 Acc: 0.7143

Epoch 56/99
----------
train Loss: 0.5305 Acc: 0.7932
test Loss: 0.5572 Acc: 0.7395

Epoch 57/99
----------
train Loss: 0.5321 Acc: 0.7932
test Loss: 0.5574 Acc: 0.7227

Epoch 58/99
----------
train Loss: 0.5190 Acc: 0.7975
test Loss: 0.5558 Acc: 0.7395

Epoch 59/99
----------
train Loss: 0.5330 Acc: 0.7511
test Loss: 0.5526 Acc: 0.7395

Epoch 60/99
----------
train Loss: 0.5247 Acc: 0.7932
test Loss: 0.5512 Acc: 0.7395

Epoch 61/99
----------
train Loss: 0.5271 Acc: 0.7890
test Loss: 0.5502 Acc: 0.7395

Epoch 62/99
----------
train Loss: 0.5114 Acc: 0.8101
test Loss: 0.5519 Acc: 0.7395

Epoch 63/99
----------
train Loss: 0.5222 Acc: 0.7932
test Loss: 0.5471 Acc: 0.7479

Epoch 64/99
----------
train Loss: 0.5139 Acc: 0.7806
test Loss: 0.5473 Acc: 0.7479

Epoch 65/99
----------
train Loss: 0.5096 Acc: 0.8143
test Loss: 0.5467 Acc: 0.7395

Epoch 66/99
----------
train Loss: 0.5084 Acc: 0.7975
test Loss: 0.5420 Acc: 0.7479

Epoch 67/99
----------
train Loss: 0.5017 Acc: 0.8354
test Loss: 0.5408 Acc: 0.7479

Epoch 68/99
----------
train Loss: 0.5111 Acc: 0.8101
test Loss: 0.5409 Acc: 0.7311

Epoch 69/99
----------
train Loss: 0.5134 Acc: 0.7932
test Loss: 0.5403 Acc: 0.7563

Epoch 70/99
----------
train Loss: 0.5067 Acc: 0.8186
test Loss: 0.5382 Acc: 0.7479

Epoch 71/99
----------
train Loss: 0.5130 Acc: 0.8186
test Loss: 0.5366 Acc: 0.7647

Epoch 72/99
----------
train Loss: 0.4926 Acc: 0.8186
test Loss: 0.5362 Acc: 0.7563

Epoch 73/99
----------
train Loss: 0.4969 Acc: 0.8059
test Loss: 0.5338 Acc: 0.7479

Epoch 74/99
----------
train Loss: 0.4846 Acc: 0.8312
test Loss: 0.5295 Acc: 0.7647

Epoch 75/99
----------
train Loss: 0.4965 Acc: 0.8059
test Loss: 0.5299 Acc: 0.7563

Epoch 76/99
----------
train Loss: 0.4868 Acc: 0.8270
test Loss: 0.5273 Acc: 0.7479

Epoch 77/99
----------
train Loss: 0.4916 Acc: 0.8228
test Loss: 0.5269 Acc: 0.7815

Epoch 78/99
----------
train Loss: 0.4947 Acc: 0.8186
test Loss: 0.5257 Acc: 0.7647

Epoch 79/99
----------
train Loss: 0.4869 Acc: 0.8397
test Loss: 0.5233 Acc: 0.7815

Epoch 80/99
----------
train Loss: 0.4787 Acc: 0.8439
test Loss: 0.5246 Acc: 0.7899

Epoch 81/99
----------
train Loss: 0.4885 Acc: 0.8059
test Loss: 0.5209 Acc: 0.7815

Epoch 82/99
----------
train Loss: 0.4893 Acc: 0.8354
test Loss: 0.5186 Acc: 0.7815

Epoch 83/99
----------
train Loss: 0.4714 Acc: 0.8354
test Loss: 0.5182 Acc: 0.7731

Epoch 84/99
----------
train Loss: 0.4653 Acc: 0.8523
test Loss: 0.5172 Acc: 0.7815

Epoch 85/99
----------
train Loss: 0.4664 Acc: 0.8565
test Loss: 0.5200 Acc: 0.7731

Epoch 86/99
----------
train Loss: 0.4598 Acc: 0.8861
test Loss: 0.5157 Acc: 0.7815

Epoch 87/99
----------
train Loss: 0.4650 Acc: 0.8481
test Loss: 0.5146 Acc: 0.7731

Epoch 88/99
----------
train Loss: 0.4571 Acc: 0.8565
test Loss: 0.5120 Acc: 0.7815

Epoch 89/99
----------
train Loss: 0.4599 Acc: 0.8481
test Loss: 0.5098 Acc: 0.7899

Epoch 90/99
----------
train Loss: 0.4618 Acc: 0.8523
test Loss: 0.5083 Acc: 0.7815

Epoch 91/99
----------
train Loss: 0.4550 Acc: 0.8523
test Loss: 0.5062 Acc: 0.7815

Epoch 92/99
----------
train Loss: 0.4688 Acc: 0.8228
test Loss: 0.5048 Acc: 0.7815

Epoch 93/99
----------
train Loss: 0.4528 Acc: 0.8734
test Loss: 0.5029 Acc: 0.7899

Epoch 94/99
----------
train Loss: 0.4515 Acc: 0.8692
test Loss: 0.5014 Acc: 0.7815

Epoch 95/99
----------
train Loss: 0.4451 Acc: 0.8650
test Loss: 0.5016 Acc: 0.7899

Epoch 96/99
----------
train Loss: 0.4472 Acc: 0.8734
test Loss: 0.4988 Acc: 0.7899

Epoch 97/99
----------
train Loss: 0.4489 Acc: 0.8565
test Loss: 0.4977 Acc: 0.7983

Epoch 98/99
----------
train Loss: 0.4248 Acc: 0.8903
test Loss: 0.4970 Acc: 0.7899

Epoch 99/99
----------
train Loss: 0.4416 Acc: 0.8861
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
test Loss: 0.4949 Acc: 0.7899

Training complete in 4m 41s
Best val Acc: 0.798319
{'Model': ['resnet18'], 'ROC_Score': [0.7794117647058822], 'F1 Score': [0.8226950354609929], 'Recall': [0.8529411764705882], 'Precision': [0.7945205479452054], 'Accuracy': [0.7899159663865546]}
Epoch 0/99
----------
train Loss: 0.6993 Acc: 0.5485
test Loss: 0.6893 Acc: 0.6134

Epoch 1/99
----------
train Loss: 0.6853 Acc: 0.5738
test Loss: 0.6860 Acc: 0.5630

Epoch 2/99
----------
train Loss: 0.6868 Acc: 0.5781
test Loss: 0.6766 Acc: 0.5798

Epoch 3/99
----------
train Loss: 0.6845 Acc: 0.5823
test Loss: 0.6708 Acc: 0.6134

Epoch 4/99
----------
train Loss: 0.6683 Acc: 0.6203
test Loss: 0.6649 Acc: 0.6303

Epoch 5/99
----------
train Loss: 0.6645 Acc: 0.6118
test Loss: 0.6598 Acc: 0.6555

Epoch 6/99
----------
train Loss: 0.6555 Acc: 0.6329
test Loss: 0.6551 Acc: 0.6639

Epoch 7/99
----------
train Loss: 0.6500 Acc: 0.6414
test Loss: 0.6511 Acc: 0.6639

Epoch 8/99
----------
train Loss: 0.6452 Acc: 0.6245
test Loss: 0.6459 Acc: 0.6723

Epoch 9/99
----------
train Loss: 0.6367 Acc: 0.6878
test Loss: 0.6428 Acc: 0.6723

Epoch 10/99
----------
train Loss: 0.6417 Acc: 0.6540
test Loss: 0.6406 Acc: 0.6807

Epoch 11/99
----------
train Loss: 0.6318 Acc: 0.6751
test Loss: 0.6358 Acc: 0.6723

Epoch 12/99
----------
train Loss: 0.6333 Acc: 0.6498
test Loss: 0.6327 Acc: 0.6723

Epoch 13/99
----------
train Loss: 0.6311 Acc: 0.6793
test Loss: 0.6287 Acc: 0.7059

Epoch 14/99
----------
train Loss: 0.6104 Acc: 0.7004
test Loss: 0.6247 Acc: 0.7227

Epoch 15/99
----------
train Loss: 0.6206 Acc: 0.6835
test Loss: 0.6230 Acc: 0.7143

Epoch 16/99
----------
train Loss: 0.6115 Acc: 0.6920
test Loss: 0.6191 Acc: 0.7059

Epoch 17/99
----------
train Loss: 0.6094 Acc: 0.6878
test Loss: 0.6139 Acc: 0.7059

Epoch 18/99
----------
train Loss: 0.6019 Acc: 0.7046
test Loss: 0.6130 Acc: 0.7227

Epoch 19/99
----------
train Loss: 0.5911 Acc: 0.7637
test Loss: 0.6103 Acc: 0.7143

Epoch 20/99
----------
train Loss: 0.5974 Acc: 0.7511
test Loss: 0.6078 Acc: 0.7059

Epoch 21/99
----------
train Loss: 0.5974 Acc: 0.7511
test Loss: 0.6032 Acc: 0.7227

Epoch 22/99
----------
train Loss: 0.5980 Acc: 0.7342
test Loss: 0.6015 Acc: 0.7227

Epoch 23/99
----------
train Loss: 0.5872 Acc: 0.7257
test Loss: 0.5999 Acc: 0.7059

Epoch 24/99
----------
train Loss: 0.5763 Acc: 0.7595
test Loss: 0.5970 Acc: 0.7311

Epoch 25/99
----------
train Loss: 0.5709 Acc: 0.7722
test Loss: 0.5947 Acc: 0.7059

Epoch 26/99
----------
train Loss: 0.5760 Acc: 0.7679
test Loss: 0.5898 Acc: 0.7311

Epoch 27/99
----------
train Loss: 0.5698 Acc: 0.7806
test Loss: 0.5864 Acc: 0.7311

Epoch 28/99
----------
train Loss: 0.5639 Acc: 0.7890
test Loss: 0.5849 Acc: 0.7311

Epoch 29/99
----------
train Loss: 0.5597 Acc: 0.8017
test Loss: 0.5826 Acc: 0.7395

Epoch 30/99
----------
train Loss: 0.5669 Acc: 0.7806
test Loss: 0.5801 Acc: 0.7395

Epoch 31/99
----------
train Loss: 0.5601 Acc: 0.7637
test Loss: 0.5766 Acc: 0.7395

Epoch 32/99
----------
train Loss: 0.5516 Acc: 0.7764
test Loss: 0.5755 Acc: 0.7395

Epoch 33/99
----------
train Loss: 0.5487 Acc: 0.7848
test Loss: 0.5746 Acc: 0.7395

Epoch 34/99
----------
train Loss: 0.5569 Acc: 0.7764
test Loss: 0.5713 Acc: 0.7395

Epoch 35/99
----------
train Loss: 0.5445 Acc: 0.7848
test Loss: 0.5680 Acc: 0.7479

Epoch 36/99
----------
train Loss: 0.5442 Acc: 0.7848
test Loss: 0.5648 Acc: 0.7311

Epoch 37/99
----------
train Loss: 0.5426 Acc: 0.7932
test Loss: 0.5626 Acc: 0.7479

Epoch 38/99
----------
train Loss: 0.5339 Acc: 0.7975
test Loss: 0.5598 Acc: 0.7479

Epoch 39/99
----------
train Loss: 0.5378 Acc: 0.8143
test Loss: 0.5582 Acc: 0.7563

Epoch 40/99
----------
train Loss: 0.5282 Acc: 0.8017
test Loss: 0.5534 Acc: 0.7479

Epoch 41/99
----------
train Loss: 0.5267 Acc: 0.8017
test Loss: 0.5528 Acc: 0.7563

Epoch 42/99
----------
train Loss: 0.5214 Acc: 0.8354
test Loss: 0.5523 Acc: 0.7647

Epoch 43/99
----------
train Loss: 0.5197 Acc: 0.8101
test Loss: 0.5488 Acc: 0.7563

Epoch 44/99
----------
train Loss: 0.5242 Acc: 0.7890
test Loss: 0.5460 Acc: 0.7479

Epoch 45/99
----------
train Loss: 0.5148 Acc: 0.8143
test Loss: 0.5425 Acc: 0.7731

Epoch 46/99
----------
train Loss: 0.5271 Acc: 0.8059
test Loss: 0.5433 Acc: 0.7899

Epoch 47/99
----------
train Loss: 0.5177 Acc: 0.8186
test Loss: 0.5386 Acc: 0.7815

Epoch 48/99
----------
train Loss: 0.5019 Acc: 0.8354
test Loss: 0.5350 Acc: 0.7815

Epoch 49/99
----------
train Loss: 0.4959 Acc: 0.8397
test Loss: 0.5329 Acc: 0.7647

Epoch 50/99
----------
train Loss: 0.5015 Acc: 0.8354
test Loss: 0.5307 Acc: 0.7815

Epoch 51/99
----------
train Loss: 0.4925 Acc: 0.8692
test Loss: 0.5260 Acc: 0.7731

Epoch 52/99
----------
train Loss: 0.4990 Acc: 0.8565
test Loss: 0.5254 Acc: 0.7731

Epoch 53/99
----------
train Loss: 0.4780 Acc: 0.8439
test Loss: 0.5228 Acc: 0.7731

Epoch 54/99
----------
train Loss: 0.4948 Acc: 0.8650
test Loss: 0.5211 Acc: 0.7731

Epoch 55/99
----------
train Loss: 0.4860 Acc: 0.8565
test Loss: 0.5195 Acc: 0.7731

Epoch 56/99
----------
train Loss: 0.4781 Acc: 0.8734
test Loss: 0.5191 Acc: 0.7815

Epoch 57/99
----------
train Loss: 0.4775 Acc: 0.8861
test Loss: 0.5161 Acc: 0.7815

Epoch 58/99
----------
train Loss: 0.4707 Acc: 0.8565
test Loss: 0.5124 Acc: 0.7815

Epoch 59/99
----------
train Loss: 0.4643 Acc: 0.8608
test Loss: 0.5088 Acc: 0.7815

Epoch 60/99
----------
train Loss: 0.4563 Acc: 0.8734
test Loss: 0.5079 Acc: 0.7815

Epoch 61/99
----------
train Loss: 0.4692 Acc: 0.8523
test Loss: 0.5074 Acc: 0.7815

Epoch 62/99
----------
train Loss: 0.4570 Acc: 0.8819
test Loss: 0.5057 Acc: 0.7815

Epoch 63/99
----------
train Loss: 0.4541 Acc: 0.8819
test Loss: 0.4998 Acc: 0.7899

Epoch 64/99
----------
train Loss: 0.4641 Acc: 0.8608
test Loss: 0.4987 Acc: 0.7815

Epoch 65/99
----------
train Loss: 0.4553 Acc: 0.8819
test Loss: 0.4960 Acc: 0.7815

Epoch 66/99
----------
train Loss: 0.4632 Acc: 0.8776
test Loss: 0.4948 Acc: 0.7899

Epoch 67/99
----------
train Loss: 0.4452 Acc: 0.8903
test Loss: 0.4911 Acc: 0.7983

Epoch 68/99
----------
train Loss: 0.4314 Acc: 0.9030
test Loss: 0.4884 Acc: 0.7899

Epoch 69/99
----------
train Loss: 0.4159 Acc: 0.9241
test Loss: 0.4863 Acc: 0.7899

Epoch 70/99
----------
train Loss: 0.4242 Acc: 0.9198
test Loss: 0.4855 Acc: 0.7899

Epoch 71/99
----------
train Loss: 0.4354 Acc: 0.9030
test Loss: 0.4843 Acc: 0.7815

Epoch 72/99
----------
train Loss: 0.4244 Acc: 0.8987
test Loss: 0.4806 Acc: 0.7983

Epoch 73/99
----------
train Loss: 0.4247 Acc: 0.8945
test Loss: 0.4802 Acc: 0.7983

Epoch 74/99
----------
train Loss: 0.4345 Acc: 0.8819
test Loss: 0.4772 Acc: 0.7983

Epoch 75/99
----------
train Loss: 0.4115 Acc: 0.9156
test Loss: 0.4732 Acc: 0.8067

Epoch 76/99
----------
train Loss: 0.4079 Acc: 0.9156
test Loss: 0.4729 Acc: 0.7983

Epoch 77/99
----------
train Loss: 0.4181 Acc: 0.9030
test Loss: 0.4676 Acc: 0.8067

Epoch 78/99
----------
train Loss: 0.4196 Acc: 0.8861
test Loss: 0.4649 Acc: 0.8067

Epoch 79/99
----------
train Loss: 0.4091 Acc: 0.9241
test Loss: 0.4638 Acc: 0.8067

Epoch 80/99
----------
train Loss: 0.4039 Acc: 0.9283
test Loss: 0.4620 Acc: 0.7983

Epoch 81/99
----------
train Loss: 0.3989 Acc: 0.9198
test Loss: 0.4610 Acc: 0.8067

Epoch 82/99
----------
train Loss: 0.3980 Acc: 0.9241
test Loss: 0.4580 Acc: 0.7983

Epoch 83/99
----------
train Loss: 0.3927 Acc: 0.9198
test Loss: 0.4561 Acc: 0.8151

Epoch 84/99
----------
train Loss: 0.3924 Acc: 0.9283
test Loss: 0.4564 Acc: 0.7983

Epoch 85/99
----------
train Loss: 0.3984 Acc: 0.9198
test Loss: 0.4530 Acc: 0.8067

Epoch 86/99
----------
train Loss: 0.3939 Acc: 0.9156
test Loss: 0.4504 Acc: 0.8151

Epoch 87/99
----------
train Loss: 0.3793 Acc: 0.9198
test Loss: 0.4485 Acc: 0.8319

Epoch 88/99
----------
train Loss: 0.3799 Acc: 0.9451
test Loss: 0.4471 Acc: 0.8319

Epoch 89/99
----------
train Loss: 0.3761 Acc: 0.9451
test Loss: 0.4424 Acc: 0.8235

Epoch 90/99
----------
train Loss: 0.3553 Acc: 0.9494
test Loss: 0.4405 Acc: 0.8319

Epoch 91/99
----------
train Loss: 0.3625 Acc: 0.9536
test Loss: 0.4389 Acc: 0.8235

Epoch 92/99
----------
train Loss: 0.3683 Acc: 0.9409
test Loss: 0.4350 Acc: 0.8319

Epoch 93/99
----------
train Loss: 0.3538 Acc: 0.9536
test Loss: 0.4315 Acc: 0.8319

Epoch 94/99
----------
train Loss: 0.3390 Acc: 0.9536
test Loss: 0.4309 Acc: 0.8319

Epoch 95/99
----------
train Loss: 0.3648 Acc: 0.9409
test Loss: 0.4268 Acc: 0.8403

Epoch 96/99
----------
train Loss: 0.3540 Acc: 0.9451
test Loss: 0.4269 Acc: 0.8319

Epoch 97/99
----------
train Loss: 0.3651 Acc: 0.9409
test Loss: 0.4223 Acc: 0.8403

Epoch 98/99
----------
train Loss: 0.3443 Acc: 0.9367
test Loss: 0.4228 Acc: 0.8403

Epoch 99/99
----------
train Loss: 0.3606 Acc: 0.9409
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
test Loss: 0.4202 Acc: 0.8319

Training complete in 5m 30s
Best val Acc: 0.840336
{'Model': ['resnet18', 'resnet34'], 'ROC_Score': [0.7794117647058822, 0.8259803921568627], 'F1 Score': [0.8226950354609929, 0.855072463768116], 'Recall': [0.8529411764705882, 0.8676470588235294], 'Precision': [0.7945205479452054, 0.8428571428571429], 'Accuracy': [0.7899159663865546, 0.8319327731092437]}
Epoch 0/99
----------
Traceback (most recent call last):
  File "/home/suresh/maulik/vag/DIK/dik.py", line 443, in <module>
    new_model, hist_1, hist_2, outputs,train_losses,test_losses,d = train_model(model_ft, dataloader, criterion, optimizer_ft, num_epochs=100)
  File "/home/suresh/maulik/vag/DIK/dik.py", line 316, in train_model
    outputs = model(inputs)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/suresh/maulik/vag/DIK/dik.py", line 140, in forward
    return self.net(x)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/resnet.py", line 275, in _forward_impl
    x = self.layer3(x)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/resnet.py", line 155, in forward
    out = self.bn3(out)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torch/nn/modules/batchnorm.py", line 171, in forward
    return F.batch_norm(
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torch/nn/functional.py", line 2450, in batch_norm
    return torch.batch_norm(
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 14.00 MiB (GPU 0; 15.74 GiB total capacity; 1.37 GiB already allocated; 15.19 MiB free; 1.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
