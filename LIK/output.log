nohup: ignoring input
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Classes:2
cuda
Epoch 0/99
----------
train Loss: 0.7471 Acc: 0.4430
test Loss: 0.6894 Acc: 0.5546

Epoch 1/99
----------
train Loss: 0.7294 Acc: 0.5021
test Loss: 0.7079 Acc: 0.4958

Epoch 2/99
----------
train Loss: 0.7136 Acc: 0.4895
test Loss: 0.7041 Acc: 0.5378

Epoch 3/99
----------
train Loss: 0.7023 Acc: 0.5274
test Loss: 0.7005 Acc: 0.5210

Epoch 4/99
----------
train Loss: 0.6970 Acc: 0.5274
test Loss: 0.6992 Acc: 0.5294

Epoch 5/99
----------
train Loss: 0.6918 Acc: 0.4895
test Loss: 0.6946 Acc: 0.5378

Epoch 6/99
----------
train Loss: 0.6891 Acc: 0.5359
test Loss: 0.6929 Acc: 0.5462

Epoch 7/99
----------
train Loss: 0.6763 Acc: 0.5359
test Loss: 0.6918 Acc: 0.5462

Epoch 8/99
----------
train Loss: 0.6799 Acc: 0.5654
test Loss: 0.6916 Acc: 0.5462

Epoch 9/99
----------
train Loss: 0.6828 Acc: 0.5316
test Loss: 0.6875 Acc: 0.5378

Epoch 10/99
----------
train Loss: 0.6677 Acc: 0.5612
test Loss: 0.6862 Acc: 0.5462

Epoch 11/99
----------
train Loss: 0.6734 Acc: 0.5865
test Loss: 0.6848 Acc: 0.5378

Epoch 12/99
----------
train Loss: 0.6624 Acc: 0.6034
test Loss: 0.6783 Acc: 0.5294

Epoch 13/99
----------
train Loss: 0.6615 Acc: 0.5949
test Loss: 0.6807 Acc: 0.5546

Epoch 14/99
----------
train Loss: 0.6514 Acc: 0.5949
test Loss: 0.6777 Acc: 0.5462

Epoch 15/99
----------
train Loss: 0.6556 Acc: 0.6076
test Loss: 0.6790 Acc: 0.5546

Epoch 16/99
----------
train Loss: 0.6475 Acc: 0.5823
test Loss: 0.6752 Acc: 0.5798

Epoch 17/99
----------
train Loss: 0.6424 Acc: 0.6203
test Loss: 0.6738 Acc: 0.5882

Epoch 18/99
----------
train Loss: 0.6454 Acc: 0.6203
test Loss: 0.6715 Acc: 0.5798

Epoch 19/99
----------
train Loss: 0.6373 Acc: 0.6287
test Loss: 0.6675 Acc: 0.5630

Epoch 20/99
----------
train Loss: 0.6384 Acc: 0.6287
test Loss: 0.6701 Acc: 0.5798

Epoch 21/99
----------
train Loss: 0.6376 Acc: 0.6371
test Loss: 0.6661 Acc: 0.5882

Epoch 22/99
----------
train Loss: 0.6377 Acc: 0.6287
test Loss: 0.6635 Acc: 0.5798

Epoch 23/99
----------
train Loss: 0.6202 Acc: 0.6667
test Loss: 0.6641 Acc: 0.5714

Epoch 24/99
----------
train Loss: 0.6189 Acc: 0.6624
test Loss: 0.6631 Acc: 0.5798

Epoch 25/99
----------
train Loss: 0.6141 Acc: 0.6878
test Loss: 0.6600 Acc: 0.5882

Epoch 26/99
----------
train Loss: 0.6167 Acc: 0.6582
test Loss: 0.6596 Acc: 0.5798

Epoch 27/99
----------
train Loss: 0.6150 Acc: 0.6667
test Loss: 0.6570 Acc: 0.5882

Epoch 28/99
----------
train Loss: 0.6159 Acc: 0.6540
test Loss: 0.6541 Acc: 0.5882

Epoch 29/99
----------
train Loss: 0.6160 Acc: 0.6414
test Loss: 0.6547 Acc: 0.5966

Epoch 30/99
----------
train Loss: 0.6080 Acc: 0.6878
test Loss: 0.6531 Acc: 0.5966

Epoch 31/99
----------
train Loss: 0.6097 Acc: 0.6751
test Loss: 0.6518 Acc: 0.5966

Epoch 32/99
----------
train Loss: 0.6019 Acc: 0.6667
test Loss: 0.6500 Acc: 0.5882

Epoch 33/99
----------
train Loss: 0.6003 Acc: 0.6878
test Loss: 0.6475 Acc: 0.6050

Epoch 34/99
----------
train Loss: 0.6104 Acc: 0.6835
test Loss: 0.6443 Acc: 0.6134

Epoch 35/99
----------
train Loss: 0.6006 Acc: 0.6878
test Loss: 0.6440 Acc: 0.6134

Epoch 36/99
----------
train Loss: 0.5948 Acc: 0.6751
test Loss: 0.6428 Acc: 0.6218

Epoch 37/99
----------
train Loss: 0.6028 Acc: 0.6878
test Loss: 0.6437 Acc: 0.6218

Epoch 38/99
----------
train Loss: 0.6001 Acc: 0.6878
test Loss: 0.6393 Acc: 0.6387

Epoch 39/99
----------
train Loss: 0.5893 Acc: 0.7131
test Loss: 0.6370 Acc: 0.6387

Epoch 40/99
----------
train Loss: 0.5833 Acc: 0.6920
test Loss: 0.6351 Acc: 0.6218

Epoch 41/99
----------
train Loss: 0.5710 Acc: 0.7215
test Loss: 0.6346 Acc: 0.6471

Epoch 42/99
----------
train Loss: 0.5979 Acc: 0.6667
test Loss: 0.6320 Acc: 0.6639

Epoch 43/99
----------
train Loss: 0.5762 Acc: 0.7257
test Loss: 0.6316 Acc: 0.6218

Epoch 44/99
----------
train Loss: 0.5813 Acc: 0.7342
test Loss: 0.6328 Acc: 0.6639

Epoch 45/99
----------
train Loss: 0.5677 Acc: 0.7257
test Loss: 0.6258 Acc: 0.6555

Epoch 46/99
----------
train Loss: 0.5669 Acc: 0.7511
test Loss: 0.6261 Acc: 0.6555

Epoch 47/99
----------
train Loss: 0.5694 Acc: 0.7384
test Loss: 0.6248 Acc: 0.6639

Epoch 48/99
----------
train Loss: 0.5728 Acc: 0.7173
test Loss: 0.6218 Acc: 0.6807

Epoch 49/99
----------
train Loss: 0.5706 Acc: 0.7215
test Loss: 0.6185 Acc: 0.6723

Epoch 50/99
----------
train Loss: 0.5695 Acc: 0.7004
test Loss: 0.6163 Acc: 0.6555

Epoch 51/99
----------
train Loss: 0.5612 Acc: 0.7215
test Loss: 0.6164 Acc: 0.6723

Epoch 52/99
----------
train Loss: 0.5696 Acc: 0.7173
test Loss: 0.6161 Acc: 0.6807

Epoch 53/99
----------
train Loss: 0.5661 Acc: 0.7384
test Loss: 0.6144 Acc: 0.6807

Epoch 54/99
----------
train Loss: 0.5638 Acc: 0.7173
test Loss: 0.6158 Acc: 0.7059

Epoch 55/99
----------
train Loss: 0.5648 Acc: 0.7595
test Loss: 0.6114 Acc: 0.6807

Epoch 56/99
----------
train Loss: 0.5443 Acc: 0.7679
test Loss: 0.6097 Acc: 0.6975

Epoch 57/99
----------
train Loss: 0.5527 Acc: 0.7637
test Loss: 0.6118 Acc: 0.7143

Epoch 58/99
----------
train Loss: 0.5440 Acc: 0.7511
test Loss: 0.6079 Acc: 0.6807

Epoch 59/99
----------
train Loss: 0.5445 Acc: 0.7764
test Loss: 0.6056 Acc: 0.7143

Epoch 60/99
----------
train Loss: 0.5279 Acc: 0.7679
test Loss: 0.6055 Acc: 0.6975

Epoch 61/99
----------
train Loss: 0.5380 Acc: 0.7553
test Loss: 0.6060 Acc: 0.6975

Epoch 62/99
----------
train Loss: 0.5356 Acc: 0.7722
test Loss: 0.6013 Acc: 0.7143

Epoch 63/99
----------
train Loss: 0.5468 Acc: 0.7553
test Loss: 0.5981 Acc: 0.7227

Epoch 64/99
----------
train Loss: 0.5341 Acc: 0.7848
test Loss: 0.5960 Acc: 0.7311

Epoch 65/99
----------
train Loss: 0.5328 Acc: 0.7932
test Loss: 0.5954 Acc: 0.7227

Epoch 66/99
----------
train Loss: 0.5262 Acc: 0.7932
test Loss: 0.5954 Acc: 0.7479

Epoch 67/99
----------
train Loss: 0.5268 Acc: 0.7932
test Loss: 0.5968 Acc: 0.7227

Epoch 68/99
----------
train Loss: 0.5251 Acc: 0.8017
test Loss: 0.5955 Acc: 0.7227

Epoch 69/99
----------
train Loss: 0.5244 Acc: 0.7975
test Loss: 0.5922 Acc: 0.7311

Epoch 70/99
----------
train Loss: 0.5130 Acc: 0.8186
test Loss: 0.5934 Acc: 0.7395

Epoch 71/99
----------
train Loss: 0.5257 Acc: 0.7890
test Loss: 0.5883 Acc: 0.7311

Epoch 72/99
----------
train Loss: 0.5164 Acc: 0.8101
test Loss: 0.5904 Acc: 0.7311

Epoch 73/99
----------
train Loss: 0.5210 Acc: 0.8059
test Loss: 0.5878 Acc: 0.7311

Epoch 74/99
----------
train Loss: 0.5211 Acc: 0.7764
test Loss: 0.5874 Acc: 0.7479

Epoch 75/99
----------
train Loss: 0.5147 Acc: 0.8101
test Loss: 0.5849 Acc: 0.7479

Epoch 76/99
----------
train Loss: 0.5133 Acc: 0.7932
test Loss: 0.5824 Acc: 0.7479

Epoch 77/99
----------
train Loss: 0.5079 Acc: 0.8312
test Loss: 0.5828 Acc: 0.7479

Epoch 78/99
----------
train Loss: 0.5014 Acc: 0.8270
test Loss: 0.5810 Acc: 0.7479

Epoch 79/99
----------
train Loss: 0.5059 Acc: 0.8059
test Loss: 0.5816 Acc: 0.7395

Epoch 80/99
----------
train Loss: 0.4929 Acc: 0.8354
test Loss: 0.5773 Acc: 0.7395

Epoch 81/99
----------
train Loss: 0.4967 Acc: 0.8101
test Loss: 0.5751 Acc: 0.7479

Epoch 82/99
----------
train Loss: 0.5177 Acc: 0.7975
test Loss: 0.5743 Acc: 0.7647

Epoch 83/99
----------
train Loss: 0.4922 Acc: 0.8101
test Loss: 0.5767 Acc: 0.7731

Epoch 84/99
----------
train Loss: 0.5078 Acc: 0.8017
test Loss: 0.5731 Acc: 0.7815

Epoch 85/99
----------
train Loss: 0.4827 Acc: 0.8312
test Loss: 0.5693 Acc: 0.7731

Epoch 86/99
----------
train Loss: 0.4970 Acc: 0.8143
test Loss: 0.5703 Acc: 0.7647

Epoch 87/99
----------
train Loss: 0.4816 Acc: 0.8397
test Loss: 0.5675 Acc: 0.7731

Epoch 88/99
----------
train Loss: 0.4993 Acc: 0.8059
test Loss: 0.5640 Acc: 0.7815

Epoch 89/99
----------
train Loss: 0.4781 Acc: 0.8608
test Loss: 0.5618 Acc: 0.7731

Epoch 90/99
----------
train Loss: 0.4960 Acc: 0.8354
test Loss: 0.5642 Acc: 0.7731

Epoch 91/99
----------
train Loss: 0.4756 Acc: 0.8481
test Loss: 0.5630 Acc: 0.7731

Epoch 92/99
----------
train Loss: 0.4755 Acc: 0.8397
test Loss: 0.5589 Acc: 0.7731

Epoch 93/99
----------
train Loss: 0.4835 Acc: 0.8439
test Loss: 0.5607 Acc: 0.7731

Epoch 94/99
----------
train Loss: 0.4762 Acc: 0.8608
test Loss: 0.5534 Acc: 0.7731

Epoch 95/99
----------
train Loss: 0.4785 Acc: 0.8608
test Loss: 0.5569 Acc: 0.7731

Epoch 96/99
----------
train Loss: 0.4895 Acc: 0.8017
test Loss: 0.5535 Acc: 0.7815

Epoch 97/99
----------
train Loss: 0.4620 Acc: 0.8692
test Loss: 0.5524 Acc: 0.7731

Epoch 98/99
----------
train Loss: 0.4638 Acc: 0.8776
test Loss: 0.5494 Acc: 0.7731

Epoch 99/99
----------
train Loss: 0.4554 Acc: 0.8734
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
test Loss: 0.5507 Acc: 0.7731

Training complete in 4m 29s
Best val Acc: 0.781513
{'Model': ['resnet18'], 'ROC_Score': [0.7573529411764706], 'F1 Score': [0.8137931034482758], 'Recall': [0.8676470588235294], 'Precision': [0.7662337662337663], 'Accuracy': [0.773109243697479]}
Epoch 0/99
----------
train Loss: 0.7045 Acc: 0.5781
test Loss: 0.7295 Acc: 0.5714

Epoch 1/99
----------
train Loss: 0.6883 Acc: 0.5738
test Loss: 0.6824 Acc: 0.5798

Epoch 2/99
----------
train Loss: 0.6813 Acc: 0.5865
test Loss: 0.6693 Acc: 0.6050

Epoch 3/99
----------
train Loss: 0.6777 Acc: 0.6203
test Loss: 0.6635 Acc: 0.6134

Epoch 4/99
----------
train Loss: 0.6720 Acc: 0.5907
test Loss: 0.6588 Acc: 0.5966

Epoch 5/99
----------
train Loss: 0.6609 Acc: 0.5696
test Loss: 0.6565 Acc: 0.6050

Epoch 6/99
----------
train Loss: 0.6484 Acc: 0.6118
test Loss: 0.6519 Acc: 0.6050

Epoch 7/99
----------
train Loss: 0.6569 Acc: 0.5992
test Loss: 0.6465 Acc: 0.6134

Epoch 8/99
----------
train Loss: 0.6347 Acc: 0.6498
test Loss: 0.6433 Acc: 0.6303

Epoch 9/99
----------
train Loss: 0.6351 Acc: 0.6414
test Loss: 0.6403 Acc: 0.6303

Epoch 10/99
----------
train Loss: 0.6319 Acc: 0.6582
test Loss: 0.6382 Acc: 0.6387

Epoch 11/99
----------
train Loss: 0.6274 Acc: 0.6287
test Loss: 0.6341 Acc: 0.6723

Epoch 12/99
----------
train Loss: 0.6196 Acc: 0.6667
test Loss: 0.6310 Acc: 0.6807

Epoch 13/99
----------
train Loss: 0.6143 Acc: 0.6793
test Loss: 0.6266 Acc: 0.6891

Epoch 14/99
----------
train Loss: 0.6116 Acc: 0.7004
test Loss: 0.6222 Acc: 0.6975

Epoch 15/99
----------
train Loss: 0.6066 Acc: 0.6878
test Loss: 0.6207 Acc: 0.7059

Epoch 16/99
----------
train Loss: 0.6031 Acc: 0.7046
test Loss: 0.6196 Acc: 0.7143

Epoch 17/99
----------
train Loss: 0.5990 Acc: 0.7131
test Loss: 0.6170 Acc: 0.7143

Epoch 18/99
----------
train Loss: 0.5926 Acc: 0.7215
test Loss: 0.6107 Acc: 0.7311

Epoch 19/99
----------
train Loss: 0.5942 Acc: 0.7257
test Loss: 0.6087 Acc: 0.7227

Epoch 20/99
----------
train Loss: 0.6007 Acc: 0.7004
test Loss: 0.6070 Acc: 0.7227

Epoch 21/99
----------
train Loss: 0.5924 Acc: 0.6962
test Loss: 0.6061 Acc: 0.7227

Epoch 22/99
----------
train Loss: 0.5854 Acc: 0.7215
test Loss: 0.6019 Acc: 0.7563

Epoch 23/99
----------
train Loss: 0.5712 Acc: 0.7679
test Loss: 0.5987 Acc: 0.7479

Epoch 24/99
----------
train Loss: 0.5573 Acc: 0.7679
test Loss: 0.5955 Acc: 0.7311

Epoch 25/99
----------
train Loss: 0.5716 Acc: 0.7553
test Loss: 0.5940 Acc: 0.7227

Epoch 26/99
----------
train Loss: 0.5695 Acc: 0.7468
test Loss: 0.5919 Acc: 0.7395

Epoch 27/99
----------
train Loss: 0.5717 Acc: 0.7426
test Loss: 0.5873 Acc: 0.7563

Epoch 28/99
----------
train Loss: 0.5523 Acc: 0.7764
test Loss: 0.5859 Acc: 0.7479

Epoch 29/99
----------
train Loss: 0.5597 Acc: 0.7722
test Loss: 0.5836 Acc: 0.7311

Epoch 30/99
----------
train Loss: 0.5658 Acc: 0.7257
test Loss: 0.5864 Acc: 0.7311

Epoch 31/99
----------
train Loss: 0.5524 Acc: 0.7679
test Loss: 0.5858 Acc: 0.7563

Epoch 32/99
----------
train Loss: 0.5483 Acc: 0.7890
test Loss: 0.5850 Acc: 0.7563

Epoch 33/99
----------
train Loss: 0.5369 Acc: 0.8101
test Loss: 0.5805 Acc: 0.7647

Epoch 34/99
----------
train Loss: 0.5409 Acc: 0.7722
test Loss: 0.5769 Acc: 0.7731

Epoch 35/99
----------
train Loss: 0.5465 Acc: 0.7679
test Loss: 0.5724 Acc: 0.7731

Epoch 36/99
----------
train Loss: 0.5311 Acc: 0.7890
test Loss: 0.5699 Acc: 0.7815

Epoch 37/99
----------
train Loss: 0.5216 Acc: 0.8059
test Loss: 0.5685 Acc: 0.7815

Epoch 38/99
----------
train Loss: 0.5225 Acc: 0.8101
test Loss: 0.5639 Acc: 0.7899

Epoch 39/99
----------
train Loss: 0.5252 Acc: 0.8059
test Loss: 0.5614 Acc: 0.7815

Epoch 40/99
----------
train Loss: 0.5144 Acc: 0.8186
test Loss: 0.5616 Acc: 0.7899

Epoch 41/99
----------
train Loss: 0.5048 Acc: 0.8312
test Loss: 0.5585 Acc: 0.7899

Epoch 42/99
----------
train Loss: 0.5124 Acc: 0.8101
test Loss: 0.5547 Acc: 0.7983

Epoch 43/99
----------
train Loss: 0.5157 Acc: 0.8228
test Loss: 0.5529 Acc: 0.7983

Epoch 44/99
----------
train Loss: 0.5051 Acc: 0.8481
test Loss: 0.5503 Acc: 0.7899

Epoch 45/99
----------
train Loss: 0.5007 Acc: 0.8523
test Loss: 0.5505 Acc: 0.7983

Epoch 46/99
----------
train Loss: 0.5026 Acc: 0.8186
test Loss: 0.5515 Acc: 0.7899

Epoch 47/99
----------
train Loss: 0.4942 Acc: 0.8565
test Loss: 0.5453 Acc: 0.7899

Epoch 48/99
----------
train Loss: 0.4902 Acc: 0.8354
test Loss: 0.5458 Acc: 0.7815

Epoch 49/99
----------
train Loss: 0.4945 Acc: 0.8186
test Loss: 0.5430 Acc: 0.7899

Epoch 50/99
----------
train Loss: 0.4793 Acc: 0.8523
test Loss: 0.5419 Acc: 0.7983

Epoch 51/99
----------
train Loss: 0.4746 Acc: 0.8481
test Loss: 0.5372 Acc: 0.8067

Epoch 52/99
----------
train Loss: 0.4847 Acc: 0.8354
test Loss: 0.5353 Acc: 0.8067

Epoch 53/99
----------
train Loss: 0.4836 Acc: 0.8608
test Loss: 0.5328 Acc: 0.8067

Epoch 54/99
----------
train Loss: 0.4710 Acc: 0.8523
test Loss: 0.5312 Acc: 0.8151

Epoch 55/99
----------
train Loss: 0.4685 Acc: 0.8692
test Loss: 0.5316 Acc: 0.7983

Epoch 56/99
----------
train Loss: 0.4565 Acc: 0.8945
test Loss: 0.5277 Acc: 0.8151

Epoch 57/99
----------
train Loss: 0.4697 Acc: 0.8481
test Loss: 0.5236 Acc: 0.8235

Epoch 58/99
----------
train Loss: 0.4462 Acc: 0.8945
test Loss: 0.5233 Acc: 0.8151

Epoch 59/99
----------
train Loss: 0.4601 Acc: 0.8565
test Loss: 0.5237 Acc: 0.8151

Epoch 60/99
----------
train Loss: 0.4678 Acc: 0.8312
test Loss: 0.5205 Acc: 0.8067

Epoch 61/99
----------
train Loss: 0.4562 Acc: 0.8776
test Loss: 0.5217 Acc: 0.8067

Epoch 62/99
----------
train Loss: 0.4371 Acc: 0.8608
test Loss: 0.5170 Acc: 0.8067

Epoch 63/99
----------
train Loss: 0.4360 Acc: 0.8692
test Loss: 0.5122 Acc: 0.8235

Epoch 64/99
----------
train Loss: 0.4362 Acc: 0.8945
test Loss: 0.5097 Acc: 0.8319

Epoch 65/99
----------
train Loss: 0.4332 Acc: 0.8903
test Loss: 0.5102 Acc: 0.8151

Epoch 66/99
----------
train Loss: 0.4451 Acc: 0.8734
test Loss: 0.5075 Acc: 0.8235

Epoch 67/99
----------
train Loss: 0.4248 Acc: 0.8819
test Loss: 0.5077 Acc: 0.8151

Epoch 68/99
----------
train Loss: 0.4303 Acc: 0.8734
test Loss: 0.5053 Acc: 0.8151

Epoch 69/99
----------
train Loss: 0.4382 Acc: 0.8776
test Loss: 0.5048 Acc: 0.8319

Epoch 70/99
----------
train Loss: 0.4474 Acc: 0.8481
test Loss: 0.4966 Acc: 0.8235

Epoch 71/99
----------
train Loss: 0.4098 Acc: 0.8987
test Loss: 0.4980 Acc: 0.8235

Epoch 72/99
----------
train Loss: 0.4275 Acc: 0.8945
test Loss: 0.4948 Acc: 0.8235

Epoch 73/99
----------
train Loss: 0.4086 Acc: 0.8987
test Loss: 0.4979 Acc: 0.8235

Epoch 74/99
----------
train Loss: 0.4250 Acc: 0.8692
test Loss: 0.4933 Acc: 0.8319

Epoch 75/99
----------
train Loss: 0.4084 Acc: 0.9156
test Loss: 0.4914 Acc: 0.8235

Epoch 76/99
----------
train Loss: 0.4041 Acc: 0.9198
test Loss: 0.4903 Acc: 0.8151

Epoch 77/99
----------
train Loss: 0.4096 Acc: 0.8776
test Loss: 0.4890 Acc: 0.8067

Epoch 78/99
----------
train Loss: 0.4030 Acc: 0.9114
test Loss: 0.4869 Acc: 0.8067

Epoch 79/99
----------
train Loss: 0.3898 Acc: 0.9198
test Loss: 0.4824 Acc: 0.8235

Epoch 80/99
----------
train Loss: 0.3892 Acc: 0.9198
test Loss: 0.4805 Acc: 0.7983

Epoch 81/99
----------
train Loss: 0.3964 Acc: 0.9114
test Loss: 0.4749 Acc: 0.8235

Epoch 82/99
----------
train Loss: 0.3943 Acc: 0.8945
test Loss: 0.4730 Acc: 0.8235

Epoch 83/99
----------
train Loss: 0.3993 Acc: 0.9030
test Loss: 0.4694 Acc: 0.8235

Epoch 84/99
----------
train Loss: 0.3717 Acc: 0.9367
test Loss: 0.4699 Acc: 0.8151

Epoch 85/99
----------
train Loss: 0.3806 Acc: 0.9367
test Loss: 0.4701 Acc: 0.8067

Epoch 86/99
----------
train Loss: 0.3848 Acc: 0.9072
test Loss: 0.4671 Acc: 0.8067

Epoch 87/99
----------
train Loss: 0.3706 Acc: 0.9409
test Loss: 0.4686 Acc: 0.8067

Epoch 88/99
----------
train Loss: 0.3720 Acc: 0.9198
test Loss: 0.4676 Acc: 0.8067

Epoch 89/99
----------
train Loss: 0.3722 Acc: 0.9198
test Loss: 0.4633 Acc: 0.8151

Epoch 90/99
----------
train Loss: 0.3530 Acc: 0.9367
test Loss: 0.4620 Acc: 0.8235

Epoch 91/99
----------
train Loss: 0.3613 Acc: 0.9325
test Loss: 0.4606 Acc: 0.8067

Epoch 92/99
----------
train Loss: 0.3543 Acc: 0.9283
test Loss: 0.4601 Acc: 0.8067

Epoch 93/99
----------
train Loss: 0.3438 Acc: 0.9451
test Loss: 0.4571 Acc: 0.8067

Epoch 94/99
----------
train Loss: 0.3439 Acc: 0.9409
test Loss: 0.4534 Acc: 0.8151

Epoch 95/99
----------
train Loss: 0.3344 Acc: 0.9620
test Loss: 0.4548 Acc: 0.8151

Epoch 96/99
----------
train Loss: 0.3581 Acc: 0.9451
test Loss: 0.4522 Acc: 0.8067

Epoch 97/99
----------
train Loss: 0.3483 Acc: 0.9451
test Loss: 0.4501 Acc: 0.8067

Epoch 98/99
----------
train Loss: 0.3397 Acc: 0.9494
test Loss: 0.4490 Acc: 0.8151

Epoch 99/99
----------
train Loss: 0.3587 Acc: 0.9536
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
test Loss: 0.4497 Acc: 0.8151

Training complete in 5m 31s
Best val Acc: 0.831933
{'Model': ['resnet18', 'resnet34'], 'ROC_Score': [0.7573529411764706, 0.8088235294117647], 'F1 Score': [0.8137931034482758, 0.8405797101449275], 'Recall': [0.8676470588235294, 0.8529411764705882], 'Precision': [0.7662337662337663, 0.8285714285714286], 'Accuracy': [0.773109243697479, 0.8151260504201681]}
Epoch 0/99
----------
train Loss: 0.7184 Acc: 0.5738
test Loss: 0.7385 Acc: 0.5714

Epoch 1/99
----------
train Loss: 0.7033 Acc: 0.5738
test Loss: 0.7010 Acc: 0.5714

Epoch 2/99
----------
train Loss: 0.6891 Acc: 0.5696
test Loss: 0.6894 Acc: 0.5714

Epoch 3/99
----------
train Loss: 0.6848 Acc: 0.5696
test Loss: 0.6833 Acc: 0.5798

Epoch 4/99
----------
train Loss: 0.6777 Acc: 0.5738
test Loss: 0.6801 Acc: 0.5714

Epoch 5/99
----------
train Loss: 0.6827 Acc: 0.5612
test Loss: 0.6795 Acc: 0.5630

Epoch 6/99
----------
train Loss: 0.6786 Acc: 0.5696
test Loss: 0.6771 Acc: 0.5714

Epoch 7/99
----------
train Loss: 0.6688 Acc: 0.5696
test Loss: 0.6757 Acc: 0.5798

Epoch 8/99
----------
train Loss: 0.6708 Acc: 0.5865
test Loss: 0.6752 Acc: 0.5882

Epoch 9/99
----------
train Loss: 0.6717 Acc: 0.5612
test Loss: 0.6746 Acc: 0.5714

Epoch 10/99
----------
train Loss: 0.6668 Acc: 0.5738
test Loss: 0.6738 Acc: 0.5882

Epoch 11/99
----------
train Loss: 0.6672 Acc: 0.5738
test Loss: 0.6734 Acc: 0.5798

Epoch 12/99
----------
train Loss: 0.6643 Acc: 0.5823
test Loss: 0.6703 Acc: 0.5882

Epoch 13/99
----------
train Loss: 0.6627 Acc: 0.5907
test Loss: 0.6702 Acc: 0.5882

Epoch 14/99
----------
train Loss: 0.6700 Acc: 0.5570
test Loss: 0.6681 Acc: 0.5966

Epoch 15/99
----------
train Loss: 0.6591 Acc: 0.6034
test Loss: 0.6682 Acc: 0.5966

Epoch 16/99
----------
train Loss: 0.6599 Acc: 0.6076
test Loss: 0.6672 Acc: 0.5882

Epoch 17/99
----------
train Loss: 0.6505 Acc: 0.6203
test Loss: 0.6660 Acc: 0.6050

Epoch 18/99
----------
train Loss: 0.6505 Acc: 0.6118
test Loss: 0.6642 Acc: 0.6134

Epoch 19/99
----------
train Loss: 0.6485 Acc: 0.6203
test Loss: 0.6640 Acc: 0.6134

Epoch 20/99
----------
train Loss: 0.6500 Acc: 0.6414
test Loss: 0.6625 Acc: 0.6134

Epoch 21/99
----------
train Loss: 0.6470 Acc: 0.6076
test Loss: 0.6623 Acc: 0.6134

Epoch 22/99
----------
train Loss: 0.6515 Acc: 0.6287
test Loss: 0.6613 Acc: 0.6134

Epoch 23/99
----------
train Loss: 0.6393 Acc: 0.6118
test Loss: 0.6597 Acc: 0.6134

Epoch 24/99
----------
train Loss: 0.6483 Acc: 0.5907
test Loss: 0.6588 Acc: 0.6218

Epoch 25/99
----------
train Loss: 0.6407 Acc: 0.6287
test Loss: 0.6571 Acc: 0.6218

Epoch 26/99
----------
train Loss: 0.6449 Acc: 0.6371
test Loss: 0.6568 Acc: 0.6303

Epoch 27/99
----------
train Loss: 0.6425 Acc: 0.6371
test Loss: 0.6564 Acc: 0.6639

Epoch 28/99
----------
train Loss: 0.6364 Acc: 0.6076
test Loss: 0.6545 Acc: 0.6471

Epoch 29/99
----------
train Loss: 0.6428 Acc: 0.6540
test Loss: 0.6547 Acc: 0.6303

Epoch 30/99
----------
train Loss: 0.6343 Acc: 0.6456
test Loss: 0.6530 Acc: 0.6303

Epoch 31/99
----------
train Loss: 0.6364 Acc: 0.6540
test Loss: 0.6517 Acc: 0.6471

Epoch 32/99
----------
train Loss: 0.6344 Acc: 0.6287
test Loss: 0.6501 Acc: 0.6471

Epoch 33/99
----------
train Loss: 0.6322 Acc: 0.6498
test Loss: 0.6492 Acc: 0.6471

Epoch 34/99
----------
train Loss: 0.6326 Acc: 0.6498
test Loss: 0.6487 Acc: 0.6723

Epoch 35/99
----------
train Loss: 0.6276 Acc: 0.6793
test Loss: 0.6477 Acc: 0.6807

Epoch 36/99
----------
train Loss: 0.6281 Acc: 0.6624
test Loss: 0.6456 Acc: 0.6555

Epoch 37/99
----------
train Loss: 0.6287 Acc: 0.6709
test Loss: 0.6458 Acc: 0.6891

Epoch 38/99
----------
train Loss: 0.6276 Acc: 0.6709
test Loss: 0.6471 Acc: 0.6891

Epoch 39/99
----------
train Loss: 0.6185 Acc: 0.7046
test Loss: 0.6454 Acc: 0.6891

Epoch 40/99
----------
train Loss: 0.6176 Acc: 0.6878
test Loss: 0.6451 Acc: 0.6723

Epoch 41/99
----------
train Loss: 0.6132 Acc: 0.6962
test Loss: 0.6425 Acc: 0.6891

Epoch 42/99
----------
train Loss: 0.6255 Acc: 0.6962
test Loss: 0.6403 Acc: 0.6975

Epoch 43/99
----------
train Loss: 0.6113 Acc: 0.6835
test Loss: 0.6407 Acc: 0.7059

Epoch 44/99
----------
train Loss: 0.6205 Acc: 0.6709
test Loss: 0.6415 Acc: 0.6807

Epoch 45/99
----------
train Loss: 0.6130 Acc: 0.7131
test Loss: 0.6400 Acc: 0.6723

Epoch 46/99
----------
train Loss: 0.6139 Acc: 0.6878
test Loss: 0.6388 Acc: 0.6723

Epoch 47/99
----------
train Loss: 0.6111 Acc: 0.7046
test Loss: 0.6379 Acc: 0.6891

Epoch 48/99
----------
train Loss: 0.6057 Acc: 0.7173
test Loss: 0.6362 Acc: 0.7059

Epoch 49/99
----------
train Loss: 0.6028 Acc: 0.7215
test Loss: 0.6355 Acc: 0.6975

Epoch 50/99
----------
train Loss: 0.6109 Acc: 0.7300
test Loss: 0.6343 Acc: 0.6891

Epoch 51/99
----------
train Loss: 0.6099 Acc: 0.7215
test Loss: 0.6314 Acc: 0.7059

Epoch 52/99
----------
train Loss: 0.6055 Acc: 0.7257
test Loss: 0.6326 Acc: 0.6891

Epoch 53/99
----------
train Loss: 0.6043 Acc: 0.7131
test Loss: 0.6310 Acc: 0.6975

Epoch 54/99
----------
train Loss: 0.6056 Acc: 0.7173
test Loss: 0.6278 Acc: 0.7059

Epoch 55/99
----------
train Loss: 0.5932 Acc: 0.7595
test Loss: 0.6270 Acc: 0.7143

Epoch 56/99
----------
train Loss: 0.5981 Acc: 0.7215
test Loss: 0.6268 Acc: 0.6975

Epoch 57/99
----------
train Loss: 0.5860 Acc: 0.7722
test Loss: 0.6266 Acc: 0.7059

Epoch 58/99
----------
train Loss: 0.5955 Acc: 0.7426
test Loss: 0.6272 Acc: 0.6975

Epoch 59/99
----------
train Loss: 0.5959 Acc: 0.7384
test Loss: 0.6252 Acc: 0.7059

Epoch 60/99
----------
train Loss: 0.5882 Acc: 0.7595
test Loss: 0.6233 Acc: 0.7059

Epoch 61/99
----------
train Loss: 0.5765 Acc: 0.7890
test Loss: 0.6236 Acc: 0.7143

Epoch 62/99
----------
train Loss: 0.5895 Acc: 0.7342
test Loss: 0.6226 Acc: 0.7143

Epoch 63/99
----------
train Loss: 0.5865 Acc: 0.7637
test Loss: 0.6190 Acc: 0.7227

Epoch 64/99
----------
train Loss: 0.5840 Acc: 0.7595
test Loss: 0.6186 Acc: 0.7227

Epoch 65/99
----------
train Loss: 0.5814 Acc: 0.7511
test Loss: 0.6212 Acc: 0.7311

Epoch 66/99
----------
train Loss: 0.5823 Acc: 0.7511
test Loss: 0.6179 Acc: 0.7227

Epoch 67/99
----------
train Loss: 0.5898 Acc: 0.7426
test Loss: 0.6177 Acc: 0.6975

Epoch 68/99
----------
train Loss: 0.5843 Acc: 0.7595
test Loss: 0.6164 Acc: 0.7227

Epoch 69/99
----------
train Loss: 0.5811 Acc: 0.7553
test Loss: 0.6143 Acc: 0.7311

Epoch 70/99
----------
train Loss: 0.5725 Acc: 0.7806
test Loss: 0.6137 Acc: 0.7143

Epoch 71/99
----------
train Loss: 0.5768 Acc: 0.7764
test Loss: 0.6109 Acc: 0.7311

Epoch 72/99
----------
train Loss: 0.5696 Acc: 0.8017
test Loss: 0.6120 Acc: 0.7227

Epoch 73/99
----------
train Loss: 0.5678 Acc: 0.7764
test Loss: 0.6105 Acc: 0.7227

Epoch 74/99
----------
train Loss: 0.5830 Acc: 0.7511
test Loss: 0.6100 Acc: 0.7311

Epoch 75/99
----------
train Loss: 0.5710 Acc: 0.7553
test Loss: 0.6088 Acc: 0.7311

Epoch 76/99
----------
train Loss: 0.5617 Acc: 0.8017
test Loss: 0.6068 Acc: 0.7143

Epoch 77/99
----------
train Loss: 0.5669 Acc: 0.7848
test Loss: 0.6057 Acc: 0.7311

Epoch 78/99
----------
train Loss: 0.5597 Acc: 0.7890
test Loss: 0.6045 Acc: 0.7227

Epoch 79/99
----------
train Loss: 0.5557 Acc: 0.7848
test Loss: 0.6027 Acc: 0.7311

Epoch 80/99
----------
train Loss: 0.5855 Acc: 0.7764
test Loss: 0.6032 Acc: 0.7227

Epoch 81/99
----------
train Loss: 0.5650 Acc: 0.7722
test Loss: 0.6040 Acc: 0.7227

Epoch 82/99
----------
train Loss: 0.5500 Acc: 0.8059
test Loss: 0.6003 Acc: 0.7395

Epoch 83/99
----------
train Loss: 0.5619 Acc: 0.8101
test Loss: 0.5990 Acc: 0.7395

Epoch 84/99
----------
train Loss: 0.5575 Acc: 0.7932
test Loss: 0.6002 Acc: 0.7311

Epoch 85/99
----------
train Loss: 0.5596 Acc: 0.7722
test Loss: 0.6019 Acc: 0.7227

Epoch 86/99
----------
train Loss: 0.5518 Acc: 0.7932
test Loss: 0.5975 Acc: 0.7311

Epoch 87/99
----------
train Loss: 0.5514 Acc: 0.8017
test Loss: 0.5949 Acc: 0.7311

Epoch 88/99
----------
train Loss: 0.5418 Acc: 0.8101
test Loss: 0.5951 Acc: 0.7395

Epoch 89/99
----------
train Loss: 0.5557 Acc: 0.7932
test Loss: 0.5912 Acc: 0.7311

Epoch 90/99
----------
train Loss: 0.5406 Acc: 0.8270
test Loss: 0.5888 Acc: 0.7311

Epoch 91/99
----------
train Loss: 0.5390 Acc: 0.8186
test Loss: 0.5897 Acc: 0.7479

Epoch 92/99
----------
train Loss: 0.5483 Acc: 0.7679
test Loss: 0.5890 Acc: 0.7227

Epoch 93/99
----------
train Loss: 0.5351 Acc: 0.8354
test Loss: 0.5886 Acc: 0.7311

Epoch 94/99
----------
train Loss: 0.5470 Acc: 0.7890
test Loss: 0.5880 Acc: 0.7311

Epoch 95/99
----------
train Loss: 0.5300 Acc: 0.8143
test Loss: 0.5846 Acc: 0.7815

Epoch 96/99
----------
train Loss: 0.5394 Acc: 0.8143
test Loss: 0.5821 Acc: 0.7563

Epoch 97/99
----------
train Loss: 0.5283 Acc: 0.8270
test Loss: 0.5800 Acc: 0.7479

Epoch 98/99
----------
train Loss: 0.5439 Acc: 0.7975
test Loss: 0.5836 Acc: 0.7311

Epoch 99/99
----------
train Loss: 0.5301 Acc: 0.8186
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet101_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet101_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
test Loss: 0.5829 Acc: 0.7479

Training complete in 5m 55s
Best val Acc: 0.781513
{'Model': ['resnet18', 'resnet34', 'resnet50'], 'ROC_Score': [0.7573529411764706, 0.8088235294117647, 0.7205882352941175], 'F1 Score': [0.8137931034482758, 0.8405797101449275, 0.8051948051948052], 'Recall': [0.8676470588235294, 0.8529411764705882, 0.9117647058823529], 'Precision': [0.7662337662337663, 0.8285714285714286, 0.7209302325581395], 'Accuracy': [0.773109243697479, 0.8151260504201681, 0.7478991596638656]}
Epoch 0/99
----------
train Loss: 0.6943 Acc: 0.5190
test Loss: 0.6911 Acc: 0.5126

Epoch 1/99
----------
train Loss: 0.6808 Acc: 0.5738
test Loss: 0.6905 Acc: 0.5378

Epoch 2/99
----------
train Loss: 0.6908 Acc: 0.5570
test Loss: 0.6831 Acc: 0.5546

Epoch 3/99
----------
train Loss: 0.6895 Acc: 0.5612
test Loss: 0.6785 Acc: 0.5798

Epoch 4/99
----------
train Loss: 0.6704 Acc: 0.5738
test Loss: 0.6779 Acc: 0.5966

Epoch 5/99
----------
train Loss: 0.6767 Acc: 0.5696
test Loss: 0.6752 Acc: 0.5882

Epoch 6/99
----------
train Loss: 0.6704 Acc: 0.5865
test Loss: 0.6758 Acc: 0.5882

Epoch 7/99
----------
train Loss: 0.6637 Acc: 0.5612
test Loss: 0.6716 Acc: 0.5966

Epoch 8/99
----------
train Loss: 0.6660 Acc: 0.5696
test Loss: 0.6727 Acc: 0.5966

Epoch 9/99
----------
train Loss: 0.6666 Acc: 0.5612
test Loss: 0.6690 Acc: 0.5882

Epoch 10/99
----------
train Loss: 0.6634 Acc: 0.5823
test Loss: 0.6683 Acc: 0.5966

Epoch 11/99
----------
train Loss: 0.6664 Acc: 0.5738
test Loss: 0.6663 Acc: 0.5966

Epoch 12/99
----------
train Loss: 0.6529 Acc: 0.5907
test Loss: 0.6656 Acc: 0.5966

Epoch 13/99
----------
train Loss: 0.6550 Acc: 0.5865
test Loss: 0.6659 Acc: 0.6050

Epoch 14/99
----------
train Loss: 0.6507 Acc: 0.5992
test Loss: 0.6628 Acc: 0.5882

Epoch 15/99
----------
train Loss: 0.6589 Acc: 0.5907
test Loss: 0.6610 Acc: 0.5798

Epoch 16/99
----------
train Loss: 0.6397 Acc: 0.5992
test Loss: 0.6586 Acc: 0.5966

Epoch 17/99
----------
train Loss: 0.6409 Acc: 0.6245
test Loss: 0.6566 Acc: 0.5882

Epoch 18/99
----------
train Loss: 0.6361 Acc: 0.5992
test Loss: 0.6557 Acc: 0.5966

Epoch 19/99
----------
train Loss: 0.6402 Acc: 0.6118
test Loss: 0.6545 Acc: 0.6134

Epoch 20/99
----------
train Loss: 0.6376 Acc: 0.6118
test Loss: 0.6538 Acc: 0.6387

Epoch 21/99
----------
train Loss: 0.6351 Acc: 0.6456
test Loss: 0.6536 Acc: 0.6134

Epoch 22/99
----------
train Loss: 0.6253 Acc: 0.6456
test Loss: 0.6521 Acc: 0.5882

Epoch 23/99
----------
train Loss: 0.6301 Acc: 0.6498
test Loss: 0.6517 Acc: 0.6218

Epoch 24/99
----------
train Loss: 0.6286 Acc: 0.6287
test Loss: 0.6530 Acc: 0.6050

Epoch 25/99
----------
train Loss: 0.6222 Acc: 0.6203
test Loss: 0.6491 Acc: 0.6303

Epoch 26/99
----------
train Loss: 0.6190 Acc: 0.6498
test Loss: 0.6458 Acc: 0.6555

Epoch 27/99
----------
train Loss: 0.6241 Acc: 0.6498
test Loss: 0.6447 Acc: 0.6555

Epoch 28/99
----------
train Loss: 0.6191 Acc: 0.6667
test Loss: 0.6422 Acc: 0.6723

Epoch 29/99
----------
train Loss: 0.6137 Acc: 0.7004
test Loss: 0.6407 Acc: 0.6639

Epoch 30/99
----------
train Loss: 0.6120 Acc: 0.6793
test Loss: 0.6391 Acc: 0.6555

Epoch 31/99
----------
train Loss: 0.6128 Acc: 0.6878
test Loss: 0.6362 Acc: 0.6807

Epoch 32/99
----------
train Loss: 0.6046 Acc: 0.6793
test Loss: 0.6350 Acc: 0.6723

Epoch 33/99
----------
train Loss: 0.6075 Acc: 0.7089
test Loss: 0.6377 Acc: 0.6471

Epoch 34/99
----------
train Loss: 0.6073 Acc: 0.6751
test Loss: 0.6349 Acc: 0.6723

Epoch 35/99
----------
train Loss: 0.6040 Acc: 0.7131
test Loss: 0.6327 Acc: 0.6639

Epoch 36/99
----------
train Loss: 0.6074 Acc: 0.6962
test Loss: 0.6319 Acc: 0.6639

Epoch 37/99
----------
train Loss: 0.5983 Acc: 0.7004
test Loss: 0.6317 Acc: 0.6639

Epoch 38/99
----------
train Loss: 0.5980 Acc: 0.7004
test Loss: 0.6309 Acc: 0.6975

Epoch 39/99
----------
train Loss: 0.5848 Acc: 0.7426
test Loss: 0.6274 Acc: 0.6723

Epoch 40/99
----------
train Loss: 0.5981 Acc: 0.7257
test Loss: 0.6269 Acc: 0.6639

Epoch 41/99
----------
train Loss: 0.5934 Acc: 0.7384
test Loss: 0.6232 Acc: 0.6807

Epoch 42/99
----------
train Loss: 0.5929 Acc: 0.7046
test Loss: 0.6219 Acc: 0.6723

Epoch 43/99
----------
train Loss: 0.5810 Acc: 0.7426
test Loss: 0.6240 Acc: 0.6807

Epoch 44/99
----------
train Loss: 0.5874 Acc: 0.7426
test Loss: 0.6199 Acc: 0.6807

Epoch 45/99
----------
train Loss: 0.5773 Acc: 0.7637
test Loss: 0.6177 Acc: 0.7143

Epoch 46/99
----------
train Loss: 0.5794 Acc: 0.7595
test Loss: 0.6159 Acc: 0.7143

Epoch 47/99
----------
train Loss: 0.5773 Acc: 0.7595
test Loss: 0.6143 Acc: 0.7311

Epoch 48/99
----------
train Loss: 0.5723 Acc: 0.7806
test Loss: 0.6096 Acc: 0.7479

Epoch 49/99
----------
train Loss: 0.5750 Acc: 0.7468
test Loss: 0.6083 Acc: 0.7395

Epoch 50/99
----------
train Loss: 0.5734 Acc: 0.7384
test Loss: 0.6043 Acc: 0.7395

Epoch 51/99
----------
train Loss: 0.5752 Acc: 0.7595
test Loss: 0.6034 Acc: 0.7311

Epoch 52/99
----------
train Loss: 0.5669 Acc: 0.7553
test Loss: 0.6008 Acc: 0.7479

Epoch 53/99
----------
train Loss: 0.5671 Acc: 0.7468
test Loss: 0.6017 Acc: 0.7731

Epoch 54/99
----------
train Loss: 0.5675 Acc: 0.7637
test Loss: 0.5997 Acc: 0.7647

Epoch 55/99
----------
train Loss: 0.5483 Acc: 0.8101
test Loss: 0.6007 Acc: 0.7563

Epoch 56/99
----------
train Loss: 0.5517 Acc: 0.7890
test Loss: 0.5957 Acc: 0.7647

Epoch 57/99
----------
train Loss: 0.5541 Acc: 0.7890
test Loss: 0.5939 Acc: 0.7479

Epoch 58/99
----------
train Loss: 0.5392 Acc: 0.8059
test Loss: 0.5932 Acc: 0.7563

Epoch 59/99
----------
train Loss: 0.5410 Acc: 0.8143
test Loss: 0.5920 Acc: 0.7563

Epoch 60/99
----------
train Loss: 0.5393 Acc: 0.8228
test Loss: 0.5917 Acc: 0.7479

Epoch 61/99
----------
train Loss: 0.5362 Acc: 0.8186
test Loss: 0.5881 Acc: 0.7563

Epoch 62/99
----------
train Loss: 0.5278 Acc: 0.8228
test Loss: 0.5852 Acc: 0.7563

Epoch 63/99
----------
train Loss: 0.5344 Acc: 0.7848
test Loss: 0.5859 Acc: 0.7563

Epoch 64/99
----------
train Loss: 0.5316 Acc: 0.8270
test Loss: 0.5824 Acc: 0.7563

Epoch 65/99
----------
train Loss: 0.5368 Acc: 0.8101
test Loss: 0.5785 Acc: 0.7647

Epoch 66/99
----------
train Loss: 0.5350 Acc: 0.7932
test Loss: 0.5771 Acc: 0.7563

Epoch 67/99
----------
train Loss: 0.5303 Acc: 0.8143
test Loss: 0.5734 Acc: 0.7563

Epoch 68/99
----------
train Loss: 0.5149 Acc: 0.8354
test Loss: 0.5716 Acc: 0.7479

Epoch 69/99
----------
train Loss: 0.5314 Acc: 0.8270
test Loss: 0.5707 Acc: 0.7479

Epoch 70/99
----------
train Loss: 0.5163 Acc: 0.8397
test Loss: 0.5695 Acc: 0.7647

Epoch 71/99
----------
train Loss: 0.5103 Acc: 0.8523
test Loss: 0.5676 Acc: 0.7815

Epoch 72/99
----------
train Loss: 0.5095 Acc: 0.8354
test Loss: 0.5675 Acc: 0.7899

Epoch 73/99
----------
train Loss: 0.5075 Acc: 0.8608
test Loss: 0.5625 Acc: 0.7815

Epoch 74/99
----------
train Loss: 0.5034 Acc: 0.8608
test Loss: 0.5598 Acc: 0.7647

Epoch 75/99
----------
train Loss: 0.5000 Acc: 0.8481
test Loss: 0.5636 Acc: 0.7815

Epoch 76/99
----------
train Loss: 0.4860 Acc: 0.8945
test Loss: 0.5582 Acc: 0.7731

Epoch 77/99
----------
train Loss: 0.5039 Acc: 0.8650
test Loss: 0.5588 Acc: 0.7731

Epoch 78/99
----------
train Loss: 0.4918 Acc: 0.8650
test Loss: 0.5520 Acc: 0.7647

Epoch 79/99
----------
train Loss: 0.4897 Acc: 0.8734
test Loss: 0.5465 Acc: 0.7731

Epoch 80/99
----------
train Loss: 0.4755 Acc: 0.8608
test Loss: 0.5467 Acc: 0.7815

Epoch 81/99
----------
train Loss: 0.4850 Acc: 0.8692
test Loss: 0.5464 Acc: 0.7731

Epoch 82/99
----------
train Loss: 0.4776 Acc: 0.8692
test Loss: 0.5405 Acc: 0.7899

Epoch 83/99
----------
train Loss: 0.4715 Acc: 0.8903
test Loss: 0.5471 Acc: 0.7731

Epoch 84/99
----------
train Loss: 0.4688 Acc: 0.8945
test Loss: 0.5406 Acc: 0.7815

Epoch 85/99
----------
train Loss: 0.4639 Acc: 0.8819
test Loss: 0.5368 Acc: 0.7815

Epoch 86/99
----------
train Loss: 0.4690 Acc: 0.8945
test Loss: 0.5370 Acc: 0.7983

Epoch 87/99
----------
train Loss: 0.4577 Acc: 0.8987
test Loss: 0.5357 Acc: 0.7899

Epoch 88/99
----------
train Loss: 0.4475 Acc: 0.9072
test Loss: 0.5329 Acc: 0.7731

Epoch 89/99
----------
train Loss: 0.4575 Acc: 0.9030
test Loss: 0.5286 Acc: 0.7731

Epoch 90/99
----------
train Loss: 0.4612 Acc: 0.8987
test Loss: 0.5282 Acc: 0.7899

Epoch 91/99
----------
train Loss: 0.4559 Acc: 0.9030
test Loss: 0.5241 Acc: 0.7815

Epoch 92/99
----------
train Loss: 0.4412 Acc: 0.9072
test Loss: 0.5258 Acc: 0.7899

Epoch 93/99
----------
train Loss: 0.4466 Acc: 0.8987
test Loss: 0.5207 Acc: 0.7815

Epoch 94/99
----------
train Loss: 0.4411 Acc: 0.9198
test Loss: 0.5128 Acc: 0.7815

Epoch 95/99
----------
train Loss: 0.4314 Acc: 0.9156
test Loss: 0.5169 Acc: 0.7899

Epoch 96/99
----------
train Loss: 0.4294 Acc: 0.9198
test Loss: 0.5237 Acc: 0.7815

Epoch 97/99
----------
train Loss: 0.4454 Acc: 0.8776
test Loss: 0.5101 Acc: 0.7815

Epoch 98/99
----------
train Loss: 0.4296 Acc: 0.9030
test Loss: 0.5114 Acc: 0.7815

Epoch 99/99
----------
train Loss: 0.4228 Acc: 0.9283
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet152_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet152_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
test Loss: 0.5067 Acc: 0.7731

Training complete in 7m 19s
Best val Acc: 0.798319
{'Model': ['resnet18', 'resnet34', 'resnet50', 'resnet101'], 'ROC_Score': [0.7573529411764706, 0.8088235294117647, 0.7205882352941175, 0.7598039215686276], 'F1 Score': [0.8137931034482758, 0.8405797101449275, 0.8051948051948052, 0.8111888111888111], 'Recall': [0.8676470588235294, 0.8529411764705882, 0.9117647058823529, 0.8529411764705882], 'Precision': [0.7662337662337663, 0.8285714285714286, 0.7209302325581395, 0.7733333333333333], 'Accuracy': [0.773109243697479, 0.8151260504201681, 0.7478991596638656, 0.773109243697479]}
Epoch 0/99
----------
train Loss: 0.6899 Acc: 0.5696
test Loss: 0.6908 Acc: 0.5798

Epoch 1/99
----------
train Loss: 0.6893 Acc: 0.5781
test Loss: 0.6867 Acc: 0.5714

Epoch 2/99
----------
train Loss: 0.6901 Acc: 0.5738
test Loss: 0.6815 Acc: 0.5714

Epoch 3/99
----------
train Loss: 0.6862 Acc: 0.5738
test Loss: 0.6786 Acc: 0.5630

Epoch 4/99
----------
train Loss: 0.6813 Acc: 0.5738
test Loss: 0.6772 Acc: 0.5714

Epoch 5/99
----------
train Loss: 0.6798 Acc: 0.5781
test Loss: 0.6768 Acc: 0.5714

Epoch 6/99
----------
train Loss: 0.6751 Acc: 0.5865
test Loss: 0.6739 Acc: 0.5714

Epoch 7/99
----------
train Loss: 0.6755 Acc: 0.5696
test Loss: 0.6725 Acc: 0.5798

Epoch 8/99
----------
train Loss: 0.6664 Acc: 0.5823
test Loss: 0.6721 Acc: 0.5714

Epoch 9/99
----------
train Loss: 0.6682 Acc: 0.5738
test Loss: 0.6688 Acc: 0.5798

Epoch 10/99
----------
train Loss: 0.6646 Acc: 0.5696
test Loss: 0.6671 Acc: 0.5630

Epoch 11/99
----------
train Loss: 0.6645 Acc: 0.6034
test Loss: 0.6670 Acc: 0.5546

Epoch 12/99
----------
train Loss: 0.6633 Acc: 0.5949
test Loss: 0.6652 Acc: 0.5546

Epoch 13/99
----------
train Loss: 0.6605 Acc: 0.5865
test Loss: 0.6648 Acc: 0.5714

Epoch 14/99
----------
train Loss: 0.6569 Acc: 0.5949
test Loss: 0.6629 Acc: 0.5630

Epoch 15/99
----------
train Loss: 0.6532 Acc: 0.5865
test Loss: 0.6618 Acc: 0.5714

Epoch 16/99
----------
train Loss: 0.6547 Acc: 0.5865
test Loss: 0.6615 Acc: 0.5798

Epoch 17/99
----------
train Loss: 0.6519 Acc: 0.6076
test Loss: 0.6595 Acc: 0.5714

Epoch 18/99
----------
train Loss: 0.6455 Acc: 0.5949
test Loss: 0.6568 Acc: 0.5714

Epoch 19/99
----------
train Loss: 0.6459 Acc: 0.6203
test Loss: 0.6559 Acc: 0.5798

Epoch 20/99
----------
train Loss: 0.6473 Acc: 0.6203
test Loss: 0.6567 Acc: 0.5630

Epoch 21/99
----------
train Loss: 0.6417 Acc: 0.6203
test Loss: 0.6541 Acc: 0.5714

Epoch 22/99
----------
train Loss: 0.6411 Acc: 0.6118
test Loss: 0.6534 Acc: 0.5882

Epoch 23/99
----------
train Loss: 0.6365 Acc: 0.6287
test Loss: 0.6532 Acc: 0.5966

Epoch 24/99
----------
train Loss: 0.6337 Acc: 0.6498
test Loss: 0.6515 Acc: 0.5882

Epoch 25/99
----------
train Loss: 0.6349 Acc: 0.6329
test Loss: 0.6488 Acc: 0.6050

Epoch 26/99
----------
train Loss: 0.6357 Acc: 0.6203
test Loss: 0.6470 Acc: 0.6134

Epoch 27/99
----------
train Loss: 0.6288 Acc: 0.6371
test Loss: 0.6467 Acc: 0.6050

Epoch 28/99
----------
train Loss: 0.6294 Acc: 0.6245
test Loss: 0.6469 Acc: 0.6218

Epoch 29/99
----------
train Loss: 0.6239 Acc: 0.6540
test Loss: 0.6442 Acc: 0.6134

Epoch 30/99
----------
train Loss: 0.6310 Acc: 0.6414
test Loss: 0.6441 Acc: 0.6050

Epoch 31/99
----------
train Loss: 0.6216 Acc: 0.6329
test Loss: 0.6397 Acc: 0.6134

Epoch 32/99
----------
train Loss: 0.6077 Acc: 0.6878
test Loss: 0.6399 Acc: 0.6303

Epoch 33/99
----------
train Loss: 0.6184 Acc: 0.6667
test Loss: 0.6396 Acc: 0.6555

Epoch 34/99
----------
train Loss: 0.6157 Acc: 0.6624
test Loss: 0.6381 Acc: 0.6387

Epoch 35/99
----------
train Loss: 0.6168 Acc: 0.6793
test Loss: 0.6369 Acc: 0.6639

Epoch 36/99
----------
train Loss: 0.6134 Acc: 0.6667
test Loss: 0.6355 Acc: 0.6555

Epoch 37/99
----------
train Loss: 0.6067 Acc: 0.6667
test Loss: 0.6338 Acc: 0.6639

Epoch 38/99
----------
train Loss: 0.6131 Acc: 0.7004
test Loss: 0.6342 Acc: 0.6723

Epoch 39/99
----------
train Loss: 0.6078 Acc: 0.7004
test Loss: 0.6312 Acc: 0.6387

Epoch 40/99
----------
train Loss: 0.6029 Acc: 0.7046
test Loss: 0.6294 Acc: 0.6891

Epoch 41/99
----------
train Loss: 0.5953 Acc: 0.7468
test Loss: 0.6281 Acc: 0.6723

Epoch 42/99
----------
train Loss: 0.5992 Acc: 0.6793
test Loss: 0.6284 Acc: 0.6807

Epoch 43/99
----------
train Loss: 0.6058 Acc: 0.6962
test Loss: 0.6277 Acc: 0.6807

Epoch 44/99
----------
train Loss: 0.5917 Acc: 0.7300
test Loss: 0.6252 Acc: 0.6807

Epoch 45/99
----------
train Loss: 0.5902 Acc: 0.7553
test Loss: 0.6239 Acc: 0.6975

Epoch 46/99
----------
train Loss: 0.5899 Acc: 0.7468
test Loss: 0.6225 Acc: 0.6975

Epoch 47/99
----------
train Loss: 0.5902 Acc: 0.7384
test Loss: 0.6195 Acc: 0.7059

Epoch 48/99
----------
train Loss: 0.5833 Acc: 0.7595
test Loss: 0.6187 Acc: 0.6975

Epoch 49/99
----------
train Loss: 0.5759 Acc: 0.8017
test Loss: 0.6165 Acc: 0.7059

Epoch 50/99
----------
train Loss: 0.5836 Acc: 0.7511
test Loss: 0.6162 Acc: 0.7059

Epoch 51/99
----------
train Loss: 0.5813 Acc: 0.7806
test Loss: 0.6152 Acc: 0.6975

Epoch 52/99
----------
train Loss: 0.5720 Acc: 0.7637
test Loss: 0.6118 Acc: 0.7143

Epoch 53/99
----------
train Loss: 0.5716 Acc: 0.7806
test Loss: 0.6092 Acc: 0.7227

Epoch 54/99
----------
train Loss: 0.5733 Acc: 0.7722
test Loss: 0.6099 Acc: 0.7311

Epoch 55/99
----------
train Loss: 0.5756 Acc: 0.7890
test Loss: 0.6074 Acc: 0.7311

Epoch 56/99
----------
train Loss: 0.5726 Acc: 0.7595
test Loss: 0.6086 Acc: 0.7227

Epoch 57/99
----------
train Loss: 0.5690 Acc: 0.7637
test Loss: 0.6059 Acc: 0.7227

Epoch 58/99
----------
train Loss: 0.5532 Acc: 0.8143
test Loss: 0.6046 Acc: 0.7395

Epoch 59/99
----------
train Loss: 0.5615 Acc: 0.8143
test Loss: 0.6022 Acc: 0.7143

Epoch 60/99
----------
train Loss: 0.5557 Acc: 0.8186
test Loss: 0.6004 Acc: 0.7311

Epoch 61/99
----------
train Loss: 0.5589 Acc: 0.7848
test Loss: 0.5992 Acc: 0.7143

Epoch 62/99
----------
train Loss: 0.5524 Acc: 0.8270
test Loss: 0.5995 Acc: 0.7311

Epoch 63/99
----------
train Loss: 0.5500 Acc: 0.8101
test Loss: 0.5971 Acc: 0.7311

Epoch 64/99
----------
train Loss: 0.5498 Acc: 0.8228
test Loss: 0.5931 Acc: 0.7395

Epoch 65/99
----------
train Loss: 0.5445 Acc: 0.8228
test Loss: 0.5924 Acc: 0.7479

Epoch 66/99
----------
train Loss: 0.5440 Acc: 0.8228
test Loss: 0.5924 Acc: 0.7227

Epoch 67/99
----------
train Loss: 0.5401 Acc: 0.8481
test Loss: 0.5907 Acc: 0.7395

Epoch 68/99
----------
train Loss: 0.5388 Acc: 0.8397
test Loss: 0.5877 Acc: 0.7227

Epoch 69/99
----------
train Loss: 0.5364 Acc: 0.8228
test Loss: 0.5857 Acc: 0.7311

Epoch 70/99
----------
train Loss: 0.5281 Acc: 0.8312
test Loss: 0.5835 Acc: 0.7311

Epoch 71/99
----------
train Loss: 0.5302 Acc: 0.8270
test Loss: 0.5803 Acc: 0.7227

Epoch 72/99
----------
train Loss: 0.5261 Acc: 0.8228
test Loss: 0.5802 Acc: 0.7311

Epoch 73/99
----------
train Loss: 0.5254 Acc: 0.8523
test Loss: 0.5795 Acc: 0.7143

Epoch 74/99
----------
train Loss: 0.5236 Acc: 0.8608
test Loss: 0.5806 Acc: 0.7227

Epoch 75/99
----------
train Loss: 0.5284 Acc: 0.8523
test Loss: 0.5823 Acc: 0.7395

Epoch 76/99
----------
train Loss: 0.5222 Acc: 0.8565
test Loss: 0.5759 Acc: 0.7311

Epoch 77/99
----------
train Loss: 0.5059 Acc: 0.8650
test Loss: 0.5727 Acc: 0.7395

Epoch 78/99
----------
train Loss: 0.5112 Acc: 0.8565
test Loss: 0.5698 Acc: 0.7395

Epoch 79/99
----------
train Loss: 0.5077 Acc: 0.8650
test Loss: 0.5655 Acc: 0.7227

Epoch 80/99
----------
train Loss: 0.5059 Acc: 0.8608
test Loss: 0.5651 Acc: 0.7311

Epoch 81/99
----------
train Loss: 0.5069 Acc: 0.8819
test Loss: 0.5645 Acc: 0.7479

Epoch 82/99
----------
train Loss: 0.5066 Acc: 0.8523
test Loss: 0.5618 Acc: 0.7479

Epoch 83/99
----------
train Loss: 0.4901 Acc: 0.8734
test Loss: 0.5618 Acc: 0.7311

Epoch 84/99
----------
train Loss: 0.4925 Acc: 0.8692
test Loss: 0.5594 Acc: 0.7563

Epoch 85/99
----------
train Loss: 0.4892 Acc: 0.8650
test Loss: 0.5572 Acc: 0.7563

Epoch 86/99
----------
train Loss: 0.4784 Acc: 0.9072
test Loss: 0.5546 Acc: 0.7479

Epoch 87/99
----------
train Loss: 0.4831 Acc: 0.8861
test Loss: 0.5539 Acc: 0.7479

Epoch 88/99
----------
train Loss: 0.4870 Acc: 0.8987
test Loss: 0.5531 Acc: 0.7647

Epoch 89/99
----------
train Loss: 0.4971 Acc: 0.8608
test Loss: 0.5521 Acc: 0.7227

Epoch 90/99
----------
train Loss: 0.4813 Acc: 0.8734
test Loss: 0.5473 Acc: 0.7227

Epoch 91/99
----------
train Loss: 0.4682 Acc: 0.9198
test Loss: 0.5424 Acc: 0.7479

Epoch 92/99
----------
train Loss: 0.4778 Acc: 0.8945
test Loss: 0.5399 Acc: 0.7227

Epoch 93/99
----------
train Loss: 0.4703 Acc: 0.9198
test Loss: 0.5407 Acc: 0.7395

Epoch 94/99
----------
train Loss: 0.4721 Acc: 0.8861
test Loss: 0.5392 Acc: 0.7647

Epoch 95/99
----------
train Loss: 0.4532 Acc: 0.9114
test Loss: 0.5328 Acc: 0.7479

Epoch 96/99
----------
train Loss: 0.4489 Acc: 0.9198
test Loss: 0.5323 Acc: 0.7479

Epoch 97/99
----------
train Loss: 0.4371 Acc: 0.9409
test Loss: 0.5291 Acc: 0.7563

Epoch 98/99
----------
train Loss: 0.4703 Acc: 0.8987
test Loss: 0.5297 Acc: 0.7563

Epoch 99/99
----------
train Loss: 0.4466 Acc: 0.9072
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet121_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet121_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
test Loss: 0.5250 Acc: 0.7647

Training complete in 9m 53s
Best val Acc: 0.764706
{'Model': ['resnet18', 'resnet34', 'resnet50', 'resnet101', 'resnet152'], 'ROC_Score': [0.7573529411764706, 0.8088235294117647, 0.7205882352941175, 0.7598039215686276, 0.7475490196078431], 'F1 Score': [0.8137931034482758, 0.8405797101449275, 0.8051948051948052, 0.8111888111888111, 0.8082191780821918], 'Recall': [0.8676470588235294, 0.8529411764705882, 0.9117647058823529, 0.8529411764705882, 0.8676470588235294], 'Precision': [0.7662337662337663, 0.8285714285714286, 0.7209302325581395, 0.7733333333333333, 0.7564102564102564], 'Accuracy': [0.773109243697479, 0.8151260504201681, 0.7478991596638656, 0.773109243697479, 0.7647058823529411]}
Epoch 0/99
----------
train Loss: 0.7211 Acc: 0.4768
test Loss: 0.7290 Acc: 0.4538

Epoch 1/99
----------
train Loss: 0.7111 Acc: 0.5063
test Loss: 0.7111 Acc: 0.5042

Epoch 2/99
----------
train Loss: 0.6730 Acc: 0.5781
test Loss: 0.7013 Acc: 0.5126

Epoch 3/99
----------
train Loss: 0.6760 Acc: 0.5443
test Loss: 0.6939 Acc: 0.5546

Epoch 4/99
----------
train Loss: 0.6708 Acc: 0.5949
test Loss: 0.6867 Acc: 0.5630

Epoch 5/99
----------
train Loss: 0.6626 Acc: 0.5949
test Loss: 0.6811 Acc: 0.5546

Epoch 6/99
----------
train Loss: 0.6596 Acc: 0.6245
test Loss: 0.6788 Acc: 0.5630

Epoch 7/99
----------
train Loss: 0.6396 Acc: 0.6582
test Loss: 0.6775 Acc: 0.5714

Epoch 8/99
----------
train Loss: 0.6492 Acc: 0.6160
test Loss: 0.6790 Acc: 0.5714

Epoch 9/99
----------
train Loss: 0.6309 Acc: 0.6582
test Loss: 0.6749 Acc: 0.5546

Epoch 10/99
----------
train Loss: 0.6452 Acc: 0.6245
test Loss: 0.6692 Acc: 0.5714

Epoch 11/99
----------
train Loss: 0.6243 Acc: 0.6624
test Loss: 0.6697 Acc: 0.5546

Epoch 12/99
----------
train Loss: 0.6255 Acc: 0.6751
test Loss: 0.6714 Acc: 0.5546

Epoch 13/99
----------
train Loss: 0.6399 Acc: 0.6118
test Loss: 0.6737 Acc: 0.5630

Epoch 14/99
----------
train Loss: 0.6303 Acc: 0.6709
test Loss: 0.6736 Acc: 0.5798

Epoch 15/99
----------
train Loss: 0.6305 Acc: 0.6414
test Loss: 0.6679 Acc: 0.5630

Epoch 16/99
----------
train Loss: 0.6141 Acc: 0.7046
test Loss: 0.6729 Acc: 0.5798

Epoch 17/99
----------
train Loss: 0.6076 Acc: 0.7089
test Loss: 0.6609 Acc: 0.5714

Epoch 18/99
----------
train Loss: 0.6180 Acc: 0.6709
test Loss: 0.6538 Acc: 0.6050

Epoch 19/99
----------
train Loss: 0.6183 Acc: 0.6835
test Loss: 0.6545 Acc: 0.6218

Epoch 20/99
----------
train Loss: 0.6167 Acc: 0.7089
test Loss: 0.6588 Acc: 0.5966

Epoch 21/99
----------
train Loss: 0.6075 Acc: 0.6793
test Loss: 0.6543 Acc: 0.5882

Epoch 22/99
----------
train Loss: 0.6023 Acc: 0.7046
test Loss: 0.6530 Acc: 0.6387

Epoch 23/99
----------
train Loss: 0.6016 Acc: 0.6920
test Loss: 0.6522 Acc: 0.6387

Epoch 24/99
----------
train Loss: 0.6040 Acc: 0.6835
test Loss: 0.6505 Acc: 0.6471

Epoch 25/99
----------
train Loss: 0.5920 Acc: 0.7046
test Loss: 0.6520 Acc: 0.6218

Epoch 26/99
----------
train Loss: 0.5985 Acc: 0.7300
test Loss: 0.6495 Acc: 0.6471

Epoch 27/99
----------
train Loss: 0.5910 Acc: 0.7215
test Loss: 0.6417 Acc: 0.6639

Epoch 28/99
----------
train Loss: 0.5887 Acc: 0.7173
test Loss: 0.6415 Acc: 0.6639

Epoch 29/99
----------
train Loss: 0.5854 Acc: 0.7468
test Loss: 0.6377 Acc: 0.6555

Epoch 30/99
----------
train Loss: 0.5657 Acc: 0.7511
test Loss: 0.6325 Acc: 0.6723

Epoch 31/99
----------
train Loss: 0.5795 Acc: 0.7257
test Loss: 0.6410 Acc: 0.6387

Epoch 32/99
----------
train Loss: 0.5784 Acc: 0.7426
test Loss: 0.6321 Acc: 0.6723

Epoch 33/99
----------
train Loss: 0.5721 Acc: 0.7511
test Loss: 0.6267 Acc: 0.6807

Epoch 34/99
----------
train Loss: 0.5733 Acc: 0.7300
test Loss: 0.6228 Acc: 0.6723

Epoch 35/99
----------
train Loss: 0.5669 Acc: 0.7468
test Loss: 0.6198 Acc: 0.6807

Epoch 36/99
----------
train Loss: 0.5657 Acc: 0.7932
test Loss: 0.6183 Acc: 0.6807

Epoch 37/99
----------
train Loss: 0.5796 Acc: 0.7722
test Loss: 0.6227 Acc: 0.6723

Epoch 38/99
----------
train Loss: 0.5707 Acc: 0.7426
test Loss: 0.6120 Acc: 0.6723

Epoch 39/99
----------
train Loss: 0.5544 Acc: 0.7637
test Loss: 0.6101 Acc: 0.6639

Epoch 40/99
----------
train Loss: 0.5609 Acc: 0.7722
test Loss: 0.6093 Acc: 0.6723

Epoch 41/99
----------
train Loss: 0.5502 Acc: 0.7722
test Loss: 0.6107 Acc: 0.6975

Epoch 42/99
----------
train Loss: 0.5533 Acc: 0.8059
test Loss: 0.6052 Acc: 0.6807

Epoch 43/99
----------
train Loss: 0.5579 Acc: 0.7595
test Loss: 0.6054 Acc: 0.7059

Epoch 44/99
----------
train Loss: 0.5454 Acc: 0.8059
test Loss: 0.6041 Acc: 0.6975

Epoch 45/99
----------
train Loss: 0.5476 Acc: 0.7595
test Loss: 0.6036 Acc: 0.6807

Epoch 46/99
----------
train Loss: 0.5435 Acc: 0.7848
test Loss: 0.5981 Acc: 0.7143

Epoch 47/99
----------
train Loss: 0.5290 Acc: 0.8143
test Loss: 0.6059 Acc: 0.7311

Epoch 48/99
----------
train Loss: 0.5407 Acc: 0.8101
test Loss: 0.6002 Acc: 0.7227

Epoch 49/99
----------
train Loss: 0.5292 Acc: 0.8186
test Loss: 0.5978 Acc: 0.6975

Epoch 50/99
----------
train Loss: 0.5380 Acc: 0.8059
test Loss: 0.6002 Acc: 0.6891

Epoch 51/99
----------
train Loss: 0.5228 Acc: 0.8397
test Loss: 0.5892 Acc: 0.7311

Epoch 52/99
----------
train Loss: 0.5308 Acc: 0.7975
test Loss: 0.5926 Acc: 0.7143

Epoch 53/99
----------
train Loss: 0.5164 Acc: 0.8354
test Loss: 0.5852 Acc: 0.7311

Epoch 54/99
----------
train Loss: 0.5207 Acc: 0.8312
test Loss: 0.6001 Acc: 0.7059

Epoch 55/99
----------
train Loss: 0.5107 Acc: 0.8439
test Loss: 0.5803 Acc: 0.7395

Epoch 56/99
----------
train Loss: 0.5077 Acc: 0.8692
test Loss: 0.5771 Acc: 0.7311

Epoch 57/99
----------
train Loss: 0.5139 Acc: 0.8270
test Loss: 0.5785 Acc: 0.7227

Epoch 58/99
----------
train Loss: 0.5044 Acc: 0.8439
test Loss: 0.5756 Acc: 0.7395

Epoch 59/99
----------
train Loss: 0.5101 Acc: 0.8397
test Loss: 0.5742 Acc: 0.7479

Epoch 60/99
----------
train Loss: 0.5020 Acc: 0.8354
test Loss: 0.5694 Acc: 0.7395

Epoch 61/99
----------
train Loss: 0.4983 Acc: 0.8481
test Loss: 0.5702 Acc: 0.7563

Epoch 62/99
----------
train Loss: 0.5078 Acc: 0.8354
test Loss: 0.5713 Acc: 0.7563

Epoch 63/99
----------
train Loss: 0.4984 Acc: 0.8481
test Loss: 0.5709 Acc: 0.7311

Epoch 64/99
----------
train Loss: 0.4917 Acc: 0.8565
test Loss: 0.5717 Acc: 0.7395

Epoch 65/99
----------
train Loss: 0.5008 Acc: 0.8312
test Loss: 0.5602 Acc: 0.7563

Epoch 66/99
----------
train Loss: 0.4819 Acc: 0.8734
test Loss: 0.5612 Acc: 0.7815

Epoch 67/99
----------
train Loss: 0.4921 Acc: 0.8481
test Loss: 0.5606 Acc: 0.7479

Epoch 68/99
----------
train Loss: 0.4836 Acc: 0.8354
test Loss: 0.5565 Acc: 0.7815

Epoch 69/99
----------
train Loss: 0.4857 Acc: 0.8608
test Loss: 0.5554 Acc: 0.7647

Epoch 70/99
----------
train Loss: 0.4855 Acc: 0.8692
test Loss: 0.5516 Acc: 0.7899

Epoch 71/99
----------
train Loss: 0.4867 Acc: 0.8270
test Loss: 0.5467 Acc: 0.7647

Epoch 72/99
----------
train Loss: 0.4801 Acc: 0.8692
test Loss: 0.5463 Acc: 0.7563

Epoch 73/99
----------
train Loss: 0.4729 Acc: 0.8565
test Loss: 0.5415 Acc: 0.7815

Epoch 74/99
----------
train Loss: 0.4749 Acc: 0.8481
test Loss: 0.5422 Acc: 0.7899

Epoch 75/99
----------
train Loss: 0.4648 Acc: 0.8692
test Loss: 0.5406 Acc: 0.7899

Epoch 76/99
----------
train Loss: 0.4614 Acc: 0.8861
test Loss: 0.5407 Acc: 0.7815

Epoch 77/99
----------
train Loss: 0.4571 Acc: 0.8861
test Loss: 0.5365 Acc: 0.7815

Epoch 78/99
----------
train Loss: 0.4418 Acc: 0.8903
test Loss: 0.5314 Acc: 0.7647

Epoch 79/99
----------
train Loss: 0.4574 Acc: 0.8650
test Loss: 0.5310 Acc: 0.7815

Epoch 80/99
----------
train Loss: 0.4324 Acc: 0.8819
test Loss: 0.5315 Acc: 0.7815

Epoch 81/99
----------
train Loss: 0.4563 Acc: 0.8819
test Loss: 0.5305 Acc: 0.7815

Epoch 82/99
----------
train Loss: 0.4330 Acc: 0.9156
test Loss: 0.5312 Acc: 0.7647

Epoch 83/99
----------
train Loss: 0.4243 Acc: 0.9241
test Loss: 0.5167 Acc: 0.7899

Epoch 84/99
----------
train Loss: 0.4304 Acc: 0.9114
test Loss: 0.5188 Acc: 0.7983

Epoch 85/99
----------
train Loss: 0.4415 Acc: 0.9030
test Loss: 0.5134 Acc: 0.8067

Epoch 86/99
----------
train Loss: 0.4461 Acc: 0.8776
test Loss: 0.5156 Acc: 0.7899

Epoch 87/99
----------
train Loss: 0.4216 Acc: 0.8987
test Loss: 0.5158 Acc: 0.7815

Epoch 88/99
----------
train Loss: 0.4316 Acc: 0.9156
test Loss: 0.5137 Acc: 0.7899

Epoch 89/99
----------
train Loss: 0.4179 Acc: 0.8945
test Loss: 0.5037 Acc: 0.7983

Epoch 90/99
----------
train Loss: 0.4295 Acc: 0.9156
test Loss: 0.5040 Acc: 0.7899

Epoch 91/99
----------
train Loss: 0.4196 Acc: 0.9241
test Loss: 0.5066 Acc: 0.8067

Epoch 92/99
----------
train Loss: 0.4216 Acc: 0.9156
test Loss: 0.5052 Acc: 0.7983

Epoch 93/99
----------
train Loss: 0.4139 Acc: 0.9114
test Loss: 0.4984 Acc: 0.8067

Epoch 94/99
----------
train Loss: 0.4190 Acc: 0.8861
test Loss: 0.4959 Acc: 0.8151

Epoch 95/99
----------
train Loss: 0.3983 Acc: 0.9283
test Loss: 0.4939 Acc: 0.8067

Epoch 96/99
----------
train Loss: 0.3899 Acc: 0.9283
test Loss: 0.5001 Acc: 0.7899

Epoch 97/99
----------
train Loss: 0.4190 Acc: 0.8819
test Loss: 0.4925 Acc: 0.8151

Epoch 98/99
----------
train Loss: 0.3858 Acc: 0.9198
test Loss: 0.4930 Acc: 0.7983

Epoch 99/99
----------
train Loss: 0.3927 Acc: 0.9241
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet161_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet161_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
test Loss: 0.4827 Acc: 0.7983

Training complete in 6m 29s
Best val Acc: 0.815126
{'Model': ['resnet18', 'resnet34', 'resnet50', 'resnet101', 'resnet152', 'densenet121'], 'ROC_Score': [0.7573529411764706, 0.8088235294117647, 0.7205882352941175, 0.7598039215686276, 0.7475490196078431, 0.7916666666666667], 'F1 Score': [0.8137931034482758, 0.8405797101449275, 0.8051948051948052, 0.8111888111888111, 0.8082191780821918, 0.8260869565217391], 'Recall': [0.8676470588235294, 0.8529411764705882, 0.9117647058823529, 0.8529411764705882, 0.8676470588235294, 0.8382352941176471], 'Precision': [0.7662337662337663, 0.8285714285714286, 0.7209302325581395, 0.7733333333333333, 0.7564102564102564, 0.8142857142857143], 'Accuracy': [0.773109243697479, 0.8151260504201681, 0.7478991596638656, 0.773109243697479, 0.7647058823529411, 0.7983193277310925]}
Epoch 0/99
----------
train Loss: 0.6971 Acc: 0.5232
test Loss: 0.6889 Acc: 0.5546

Epoch 1/99
----------
train Loss: 0.6967 Acc: 0.5316
test Loss: 0.6981 Acc: 0.5378

Epoch 2/99
----------
train Loss: 0.6911 Acc: 0.5359
test Loss: 0.7035 Acc: 0.5210

Epoch 3/99
----------
train Loss: 0.6854 Acc: 0.5527
test Loss: 0.6998 Acc: 0.5462

Epoch 4/99
----------
train Loss: 0.6849 Acc: 0.5696
test Loss: 0.6980 Acc: 0.5462

Epoch 5/99
----------
train Loss: 0.6794 Acc: 0.5696
test Loss: 0.6952 Acc: 0.5546

Epoch 6/99
----------
train Loss: 0.6793 Acc: 0.5738
test Loss: 0.6939 Acc: 0.5546

Epoch 7/99
----------
train Loss: 0.6663 Acc: 0.5738
test Loss: 0.6907 Acc: 0.5294

Epoch 8/99
----------
train Loss: 0.6634 Acc: 0.5907
test Loss: 0.6887 Acc: 0.5378

Epoch 9/99
----------
train Loss: 0.6659 Acc: 0.5865
test Loss: 0.6865 Acc: 0.5294

Epoch 10/99
----------
train Loss: 0.6613 Acc: 0.5907
test Loss: 0.6825 Acc: 0.5546

Epoch 11/99
----------
train Loss: 0.6538 Acc: 0.6245
test Loss: 0.6797 Acc: 0.5630

Epoch 12/99
----------
train Loss: 0.6531 Acc: 0.6118
test Loss: 0.6778 Acc: 0.5630

Epoch 13/99
----------
train Loss: 0.6559 Acc: 0.6160
test Loss: 0.6767 Acc: 0.5630

Epoch 14/99
----------
train Loss: 0.6493 Acc: 0.6118
test Loss: 0.6754 Acc: 0.5630

Epoch 15/99
----------
train Loss: 0.6498 Acc: 0.6160
test Loss: 0.6710 Acc: 0.5546

Epoch 16/99
----------
train Loss: 0.6487 Acc: 0.6160
test Loss: 0.6685 Acc: 0.5630

Epoch 17/99
----------
train Loss: 0.6470 Acc: 0.6160
test Loss: 0.6667 Acc: 0.5882

Epoch 18/99
----------
train Loss: 0.6349 Acc: 0.6371
test Loss: 0.6657 Acc: 0.5798

Epoch 19/99
----------
train Loss: 0.6384 Acc: 0.6329
test Loss: 0.6637 Acc: 0.5966

Epoch 20/99
----------
train Loss: 0.6314 Acc: 0.6582
test Loss: 0.6625 Acc: 0.5882

Epoch 21/99
----------
train Loss: 0.6313 Acc: 0.6245
test Loss: 0.6590 Acc: 0.5714

Epoch 22/99
----------
train Loss: 0.6333 Acc: 0.6414
test Loss: 0.6567 Acc: 0.5798

Epoch 23/99
----------
train Loss: 0.6309 Acc: 0.6414
test Loss: 0.6571 Acc: 0.5882

Epoch 24/99
----------
train Loss: 0.6242 Acc: 0.6582
test Loss: 0.6535 Acc: 0.5966

Epoch 25/99
----------
train Loss: 0.6194 Acc: 0.6582
test Loss: 0.6512 Acc: 0.6050

Epoch 26/99
----------
train Loss: 0.6243 Acc: 0.6751
test Loss: 0.6486 Acc: 0.6050

Epoch 27/99
----------
train Loss: 0.6251 Acc: 0.6624
test Loss: 0.6474 Acc: 0.6050

Epoch 28/99
----------
train Loss: 0.6159 Acc: 0.6624
test Loss: 0.6443 Acc: 0.6134

Epoch 29/99
----------
train Loss: 0.6062 Acc: 0.6878
test Loss: 0.6436 Acc: 0.6218

Epoch 30/99
----------
train Loss: 0.6091 Acc: 0.6835
test Loss: 0.6421 Acc: 0.6050

Epoch 31/99
----------
train Loss: 0.6104 Acc: 0.6709
test Loss: 0.6389 Acc: 0.6218

Epoch 32/99
----------
train Loss: 0.6106 Acc: 0.6835
test Loss: 0.6373 Acc: 0.6471

Epoch 33/99
----------
train Loss: 0.5988 Acc: 0.7173
test Loss: 0.6372 Acc: 0.6387

Epoch 34/99
----------
train Loss: 0.6000 Acc: 0.7131
test Loss: 0.6329 Acc: 0.6555

Epoch 35/99
----------
train Loss: 0.6030 Acc: 0.6709
test Loss: 0.6317 Acc: 0.6471

Epoch 36/99
----------
train Loss: 0.5966 Acc: 0.7257
test Loss: 0.6307 Acc: 0.6639

Epoch 37/99
----------
train Loss: 0.5964 Acc: 0.7131
test Loss: 0.6302 Acc: 0.6723

Epoch 38/99
----------
train Loss: 0.5953 Acc: 0.7089
test Loss: 0.6260 Acc: 0.6471

Epoch 39/99
----------
train Loss: 0.5907 Acc: 0.7173
test Loss: 0.6240 Acc: 0.6975

Epoch 40/99
----------
train Loss: 0.5928 Acc: 0.7089
test Loss: 0.6222 Acc: 0.6639

Epoch 41/99
----------
train Loss: 0.5857 Acc: 0.7173
test Loss: 0.6234 Acc: 0.6975

Epoch 42/99
----------
train Loss: 0.5821 Acc: 0.7426
test Loss: 0.6180 Acc: 0.6807

Epoch 43/99
----------
train Loss: 0.5790 Acc: 0.7342
test Loss: 0.6165 Acc: 0.6807

Epoch 44/99
----------
train Loss: 0.5741 Acc: 0.7679
test Loss: 0.6167 Acc: 0.6975

Epoch 45/99
----------
train Loss: 0.5812 Acc: 0.7384
test Loss: 0.6149 Acc: 0.6975

Epoch 46/99
----------
train Loss: 0.5745 Acc: 0.7468
test Loss: 0.6167 Acc: 0.7143

Epoch 47/99
----------
train Loss: 0.5731 Acc: 0.7511
test Loss: 0.6119 Acc: 0.7143

Epoch 48/99
----------
train Loss: 0.5643 Acc: 0.7764
test Loss: 0.6110 Acc: 0.7143

Epoch 49/99
----------
train Loss: 0.5669 Acc: 0.7722
test Loss: 0.6098 Acc: 0.7059

Epoch 50/99
----------
train Loss: 0.5656 Acc: 0.7764
test Loss: 0.6078 Acc: 0.7311

Epoch 51/99
----------
train Loss: 0.5681 Acc: 0.7679
test Loss: 0.6061 Acc: 0.7227

Epoch 52/99
----------
train Loss: 0.5690 Acc: 0.7722
test Loss: 0.6048 Acc: 0.7143

Epoch 53/99
----------
train Loss: 0.5550 Acc: 0.7890
test Loss: 0.6032 Acc: 0.7227

Epoch 54/99
----------
train Loss: 0.5629 Acc: 0.7722
test Loss: 0.6016 Acc: 0.7227

Epoch 55/99
----------
train Loss: 0.5539 Acc: 0.7722
test Loss: 0.5994 Acc: 0.7227

Epoch 56/99
----------
train Loss: 0.5517 Acc: 0.7722
test Loss: 0.5973 Acc: 0.7059

Epoch 57/99
----------
train Loss: 0.5454 Acc: 0.7975
test Loss: 0.5973 Acc: 0.7311

Epoch 58/99
----------
train Loss: 0.5348 Acc: 0.8354
test Loss: 0.5953 Acc: 0.7395

Epoch 59/99
----------
train Loss: 0.5349 Acc: 0.7890
test Loss: 0.5913 Acc: 0.7311

Epoch 60/99
----------
train Loss: 0.5444 Acc: 0.8101
test Loss: 0.5890 Acc: 0.7311

Epoch 61/99
----------
train Loss: 0.5360 Acc: 0.8143
test Loss: 0.5869 Acc: 0.7395

Epoch 62/99
----------
train Loss: 0.5274 Acc: 0.8312
test Loss: 0.5842 Acc: 0.7395

Epoch 63/99
----------
train Loss: 0.5314 Acc: 0.7975
test Loss: 0.5849 Acc: 0.7479

Epoch 64/99
----------
train Loss: 0.5283 Acc: 0.8143
test Loss: 0.5833 Acc: 0.7479

Epoch 65/99
----------
train Loss: 0.5279 Acc: 0.8270
test Loss: 0.5820 Acc: 0.7563

Epoch 66/99
----------
train Loss: 0.5353 Acc: 0.8059
test Loss: 0.5830 Acc: 0.7563

Epoch 67/99
----------
train Loss: 0.5197 Acc: 0.8312
test Loss: 0.5787 Acc: 0.7479

Epoch 68/99
----------
train Loss: 0.5194 Acc: 0.8270
test Loss: 0.5745 Acc: 0.7563

Epoch 69/99
----------
train Loss: 0.5157 Acc: 0.8397
test Loss: 0.5764 Acc: 0.7395

Epoch 70/99
----------
train Loss: 0.5268 Acc: 0.7890
test Loss: 0.5734 Acc: 0.7479

Epoch 71/99
----------
train Loss: 0.5134 Acc: 0.8354
test Loss: 0.5730 Acc: 0.7647

Epoch 72/99
----------
train Loss: 0.5063 Acc: 0.8481
test Loss: 0.5689 Acc: 0.7479

Epoch 73/99
----------
train Loss: 0.5144 Acc: 0.8354
test Loss: 0.5662 Acc: 0.7563

Epoch 74/99
----------
train Loss: 0.5180 Acc: 0.8270
test Loss: 0.5651 Acc: 0.7563

Epoch 75/99
----------
train Loss: 0.5209 Acc: 0.8228
test Loss: 0.5618 Acc: 0.7815

Epoch 76/99
----------
train Loss: 0.4999 Acc: 0.8481
test Loss: 0.5607 Acc: 0.7731

Epoch 77/99
----------
train Loss: 0.5023 Acc: 0.8650
test Loss: 0.5606 Acc: 0.7647

Epoch 78/99
----------
train Loss: 0.5046 Acc: 0.8523
test Loss: 0.5598 Acc: 0.7731

Epoch 79/99
----------
train Loss: 0.5006 Acc: 0.8565
test Loss: 0.5577 Acc: 0.7731

Epoch 80/99
----------
train Loss: 0.5040 Acc: 0.8608
test Loss: 0.5546 Acc: 0.7731

Epoch 81/99
----------
train Loss: 0.4965 Acc: 0.8608
test Loss: 0.5523 Acc: 0.7647

Epoch 82/99
----------
train Loss: 0.4794 Acc: 0.8903
test Loss: 0.5504 Acc: 0.7899

Epoch 83/99
----------
train Loss: 0.4937 Acc: 0.8354
test Loss: 0.5514 Acc: 0.7899

Epoch 84/99
----------
train Loss: 0.4823 Acc: 0.8776
test Loss: 0.5476 Acc: 0.7815

Epoch 85/99
----------
train Loss: 0.4801 Acc: 0.8776
test Loss: 0.5449 Acc: 0.7815

Epoch 86/99
----------
train Loss: 0.4900 Acc: 0.8397
test Loss: 0.5465 Acc: 0.7815

Epoch 87/99
----------
train Loss: 0.4808 Acc: 0.8650
test Loss: 0.5488 Acc: 0.7899

Epoch 88/99
----------
train Loss: 0.4806 Acc: 0.8692
test Loss: 0.5407 Acc: 0.7983

Epoch 89/99
----------
train Loss: 0.4695 Acc: 0.9030
test Loss: 0.5370 Acc: 0.7899

Epoch 90/99
----------
train Loss: 0.4737 Acc: 0.8776
test Loss: 0.5362 Acc: 0.7731

Epoch 91/99
----------
train Loss: 0.4662 Acc: 0.8903
test Loss: 0.5349 Acc: 0.8067

Epoch 92/99
----------
train Loss: 0.4837 Acc: 0.8861
test Loss: 0.5323 Acc: 0.7983

Epoch 93/99
----------
train Loss: 0.4604 Acc: 0.9072
test Loss: 0.5312 Acc: 0.7815

Epoch 94/99
----------
train Loss: 0.4511 Acc: 0.8945
test Loss: 0.5280 Acc: 0.7899

Epoch 95/99
----------
train Loss: 0.4631 Acc: 0.8945
test Loss: 0.5259 Acc: 0.7983

Epoch 96/99
----------
train Loss: 0.4548 Acc: 0.8861
test Loss: 0.5233 Acc: 0.7983

Epoch 97/99
----------
train Loss: 0.4478 Acc: 0.9114
test Loss: 0.5217 Acc: 0.7815

Epoch 98/99
----------
train Loss: 0.4567 Acc: 0.8987
test Loss: 0.5199 Acc: 0.7983

Epoch 99/99
----------
train Loss: 0.4475 Acc: 0.9072
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=DenseNet201_Weights.IMAGENET1K_V1`. You can also use `weights=DenseNet201_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Downloading: "https://download.pytorch.org/models/densenet201-c1103571.pth" to /home/suresh/.cache/torch/hub/checkpoints/densenet201-c1103571.pth
test Loss: 0.5175 Acc: 0.7983

Training complete in 10m 12s
Best val Acc: 0.806723
{'Model': ['resnet18', 'resnet34', 'resnet50', 'resnet101', 'resnet152', 'densenet121', 'densenet161'], 'ROC_Score': [0.7573529411764706, 0.8088235294117647, 0.7205882352941175, 0.7598039215686276, 0.7475490196078431, 0.7916666666666667, 0.7867647058823529], 'F1 Score': [0.8137931034482758, 0.8405797101449275, 0.8051948051948052, 0.8111888111888111, 0.8082191780821918, 0.8260869565217391, 0.8309859154929577], 'Recall': [0.8676470588235294, 0.8529411764705882, 0.9117647058823529, 0.8529411764705882, 0.8676470588235294, 0.8382352941176471, 0.8676470588235294], 'Precision': [0.7662337662337663, 0.8285714285714286, 0.7209302325581395, 0.7733333333333333, 0.7564102564102564, 0.8142857142857143, 0.7972972972972973], 'Accuracy': [0.773109243697479, 0.8151260504201681, 0.7478991596638656, 0.773109243697479, 0.7647058823529411, 0.7983193277310925, 0.7983193277310925]}
  0%|                                                                                                                                          | 0.00/77.4M [00:00<?, ?B/s]  0%|                                                                                                                                 | 104k/77.4M [00:00<01:20, 1.00MB/s]  1%|                                                                                                                                 | 400k/77.4M [00:00<00:37, 2.15MB/s]  1%|                                                                                                                               | 1.00M/77.4M [00:00<00:19, 4.04MB/s]  3%|                                                                                                                             | 2.14M/77.4M [00:00<00:11, 7.12MB/s]  6%|                                                                                                                         | 4.38M/77.4M [00:00<00:05, 13.0MB/s] 11%|                                                                                                                  | 8.84M/77.4M [00:00<00:02, 24.4MB/s] 22%|                                                                                                     | 16.6M/77.4M [00:00<00:01, 43.1MB/s] 27%|                                                                                              | 20.8M/77.4M [00:00<00:02, 27.2MB/s] 31%|                                                                                         | 24.0M/77.4M [00:01<00:02, 22.0MB/s] 36%|                                                                                  | 27.8M/77.4M [00:01<00:02, 18.8MB/s] 42%|                                                                           | 32.5M/77.4M [00:01<00:02, 18.8MB/s] 47%|                                                                    | 36.4M/77.4M [00:02<00:02, 17.1MB/s] 53%|                                                             | 40.8M/77.4M [00:02<00:02, 16.7MB/s] 59%|                                                     | 45.3M/77.4M [00:02<00:02, 16.6MB/s] 64%|                                              | 49.7M/77.4M [00:02<00:01, 16.4MB/s] 70%|                                      | 54.2M/77.4M [00:03<00:01, 16.3MB/s] 76%|                               | 58.6M/77.4M [00:03<00:01, 16.2MB/s] 82%|                       | 63.2M/77.4M [00:03<00:00, 16.1MB/s] 88%|               | 68.0M/77.4M [00:04<00:00, 16.9MB/s] 93%|         | 71.7M/77.4M [00:04<00:00, 16.0MB/s] 99%| | 76.7M/77.4M [00:04<00:00, 17.2MB/s]100%|| 77.4M/77.4M [00:04<00:00, 17.5MB/s]
Epoch 0/99
----------
train Loss: 0.7547 Acc: 0.4177
test Loss: 0.6960 Acc: 0.5042

Epoch 1/99
----------
train Loss: 0.7225 Acc: 0.4810
test Loss: 0.6953 Acc: 0.5714

Epoch 2/99
----------
train Loss: 0.6963 Acc: 0.5274
test Loss: 0.6927 Acc: 0.5714

Epoch 3/99
----------
train Loss: 0.6849 Acc: 0.5527
test Loss: 0.6902 Acc: 0.5294

Epoch 4/99
----------
train Loss: 0.6780 Acc: 0.5612
test Loss: 0.6786 Acc: 0.5546

Epoch 5/99
----------
train Loss: 0.6594 Acc: 0.6287
test Loss: 0.6725 Acc: 0.5462

Epoch 6/99
----------
train Loss: 0.6629 Acc: 0.6287
test Loss: 0.6725 Acc: 0.5378

Epoch 7/99
----------
train Loss: 0.6502 Acc: 0.6329
test Loss: 0.6760 Acc: 0.5882

Epoch 8/99
----------
train Loss: 0.6499 Acc: 0.6456
test Loss: 0.6627 Acc: 0.5714

Epoch 9/99
----------
train Loss: 0.6503 Acc: 0.6287
test Loss: 0.6592 Acc: 0.5714

Epoch 10/99
----------
train Loss: 0.6480 Acc: 0.6329
test Loss: 0.6608 Acc: 0.5798

Epoch 11/99
----------
train Loss: 0.6380 Acc: 0.6624
test Loss: 0.6564 Acc: 0.5882

Epoch 12/99
----------
train Loss: 0.6312 Acc: 0.6667
test Loss: 0.6571 Acc: 0.6050

Epoch 13/99
----------
train Loss: 0.6313 Acc: 0.6624
test Loss: 0.6553 Acc: 0.6050

Epoch 14/99
----------
train Loss: 0.6316 Acc: 0.6456
test Loss: 0.6535 Acc: 0.5798

Epoch 15/99
----------
train Loss: 0.6222 Acc: 0.6751
test Loss: 0.6506 Acc: 0.5966

Epoch 16/99
----------
train Loss: 0.6257 Acc: 0.6920
test Loss: 0.6465 Acc: 0.6050

Epoch 17/99
----------
train Loss: 0.6081 Acc: 0.6920
test Loss: 0.6421 Acc: 0.6134

Epoch 18/99
----------
train Loss: 0.6138 Acc: 0.6878
test Loss: 0.6434 Acc: 0.6303

Epoch 19/99
----------
train Loss: 0.6068 Acc: 0.6878
test Loss: 0.6397 Acc: 0.6555

Epoch 20/99
----------
train Loss: 0.6045 Acc: 0.7089
test Loss: 0.6397 Acc: 0.6387

Epoch 21/99
----------
train Loss: 0.6037 Acc: 0.7300
test Loss: 0.6444 Acc: 0.6471

Epoch 22/99
----------
train Loss: 0.5993 Acc: 0.7215
test Loss: 0.6337 Acc: 0.6471

Epoch 23/99
----------
train Loss: 0.5963 Acc: 0.7131
test Loss: 0.6357 Acc: 0.6639

Epoch 24/99
----------
train Loss: 0.5988 Acc: 0.7004
test Loss: 0.6296 Acc: 0.6975

Epoch 25/99
----------
train Loss: 0.5925 Acc: 0.7215
test Loss: 0.6331 Acc: 0.6387

Epoch 26/99
----------
train Loss: 0.5871 Acc: 0.7806
test Loss: 0.6252 Acc: 0.6807

Epoch 27/99
----------
train Loss: 0.6014 Acc: 0.7342
test Loss: 0.6238 Acc: 0.6723

Epoch 28/99
----------
train Loss: 0.5850 Acc: 0.7257
test Loss: 0.6236 Acc: 0.6975

Epoch 29/99
----------
train Loss: 0.5774 Acc: 0.7595
test Loss: 0.6237 Acc: 0.6891

Epoch 30/99
----------
train Loss: 0.5821 Acc: 0.7300
test Loss: 0.6206 Acc: 0.7311

Epoch 31/99
----------
train Loss: 0.5724 Acc: 0.7679
test Loss: 0.6220 Acc: 0.7227

Epoch 32/99
----------
train Loss: 0.5758 Acc: 0.7806
test Loss: 0.6212 Acc: 0.7227

Epoch 33/99
----------
train Loss: 0.5753 Acc: 0.7764
test Loss: 0.6146 Acc: 0.6975

Epoch 34/99
----------
train Loss: 0.5643 Acc: 0.7890
test Loss: 0.6168 Acc: 0.7311

Epoch 35/99
----------
train Loss: 0.5588 Acc: 0.7722
test Loss: 0.6086 Acc: 0.7731

Epoch 36/99
----------
train Loss: 0.5601 Acc: 0.7975
test Loss: 0.6170 Acc: 0.6807

Epoch 37/99
----------
train Loss: 0.5626 Acc: 0.7806
test Loss: 0.6068 Acc: 0.6975

Epoch 38/99
----------
train Loss: 0.5574 Acc: 0.7848
test Loss: 0.6028 Acc: 0.7479

Epoch 39/99
----------
train Loss: 0.5543 Acc: 0.8101
test Loss: 0.6052 Acc: 0.7395

Epoch 40/99
----------
train Loss: 0.5525 Acc: 0.7932
test Loss: 0.5987 Acc: 0.7395

Epoch 41/99
----------
train Loss: 0.5450 Acc: 0.8312
test Loss: 0.5999 Acc: 0.7143

Epoch 42/99
----------
train Loss: 0.5563 Acc: 0.7848
test Loss: 0.5973 Acc: 0.7395

Epoch 43/99
----------
train Loss: 0.5524 Acc: 0.7890
test Loss: 0.5947 Acc: 0.7563

Epoch 44/99
----------
train Loss: 0.5440 Acc: 0.7890
test Loss: 0.5978 Acc: 0.7479

Epoch 45/99
----------
train Loss: 0.5370 Acc: 0.8270
test Loss: 0.5935 Acc: 0.7563

Epoch 46/99
----------
train Loss: 0.5496 Acc: 0.8017
test Loss: 0.5900 Acc: 0.7479

Epoch 47/99
----------
train Loss: 0.5484 Acc: 0.8017
test Loss: 0.5855 Acc: 0.7647

Epoch 48/99
----------
train Loss: 0.5425 Acc: 0.7975
test Loss: 0.5863 Acc: 0.7731

Epoch 49/99
----------
train Loss: 0.5253 Acc: 0.8608
test Loss: 0.5818 Acc: 0.7647

Epoch 50/99
----------
train Loss: 0.5200 Acc: 0.8523
test Loss: 0.5821 Acc: 0.7479

Epoch 51/99
----------
train Loss: 0.5382 Acc: 0.8186
test Loss: 0.5825 Acc: 0.7563

Epoch 52/99
----------
train Loss: 0.5174 Acc: 0.8354
test Loss: 0.5803 Acc: 0.7563

Epoch 53/99
----------
train Loss: 0.5191 Acc: 0.8481
test Loss: 0.5772 Acc: 0.7731

Epoch 54/99
----------
train Loss: 0.5133 Acc: 0.8565
test Loss: 0.5747 Acc: 0.7731

Epoch 55/99
----------
train Loss: 0.5138 Acc: 0.8270
test Loss: 0.5735 Acc: 0.7731

Epoch 56/99
----------
train Loss: 0.5107 Acc: 0.8650
test Loss: 0.5696 Acc: 0.7731

Epoch 57/99
----------
train Loss: 0.5086 Acc: 0.8439
test Loss: 0.5692 Acc: 0.7731

Epoch 58/99
----------
train Loss: 0.5086 Acc: 0.8565
test Loss: 0.5665 Acc: 0.7731

Epoch 59/99
----------
train Loss: 0.4974 Acc: 0.8650
test Loss: 0.5651 Acc: 0.7899

Epoch 60/99
----------
train Loss: 0.4928 Acc: 0.8608
test Loss: 0.5630 Acc: 0.7983

Epoch 61/99
----------
train Loss: 0.4948 Acc: 0.8523
test Loss: 0.5598 Acc: 0.7815

Epoch 62/99
----------
train Loss: 0.4868 Acc: 0.8776
test Loss: 0.5609 Acc: 0.7899

Epoch 63/99
----------
train Loss: 0.4930 Acc: 0.8608
test Loss: 0.5664 Acc: 0.7983

Epoch 64/99
----------
train Loss: 0.4927 Acc: 0.8819
test Loss: 0.5577 Acc: 0.7899

Epoch 65/99
----------
train Loss: 0.4834 Acc: 0.8692
test Loss: 0.5548 Acc: 0.7815

Epoch 66/99
----------
train Loss: 0.4854 Acc: 0.8565
test Loss: 0.5497 Acc: 0.8067

Epoch 67/99
----------
train Loss: 0.4811 Acc: 0.8945
test Loss: 0.5495 Acc: 0.7899

Epoch 68/99
----------
train Loss: 0.4873 Acc: 0.8819
test Loss: 0.5449 Acc: 0.7983

Epoch 69/99
----------
train Loss: 0.4807 Acc: 0.8776
test Loss: 0.5475 Acc: 0.7899

Epoch 70/99
----------
train Loss: 0.4768 Acc: 0.8565
test Loss: 0.5438 Acc: 0.8151

Epoch 71/99
----------
train Loss: 0.4750 Acc: 0.8734
test Loss: 0.5403 Acc: 0.7983

Epoch 72/99
----------
train Loss: 0.4775 Acc: 0.8650
test Loss: 0.5452 Acc: 0.7815

Epoch 73/99
----------
train Loss: 0.4623 Acc: 0.8987
test Loss: 0.5375 Acc: 0.8067

Epoch 74/99
----------
train Loss: 0.4606 Acc: 0.8903
test Loss: 0.5389 Acc: 0.7983

Epoch 75/99
----------
train Loss: 0.4628 Acc: 0.8945
test Loss: 0.5329 Acc: 0.7983

Epoch 76/99
----------
train Loss: 0.4706 Acc: 0.8608
test Loss: 0.5342 Acc: 0.7815

Epoch 77/99
----------
train Loss: 0.4544 Acc: 0.9114
test Loss: 0.5297 Acc: 0.7983

Epoch 78/99
----------
train Loss: 0.4415 Acc: 0.9030
test Loss: 0.5306 Acc: 0.8151

Epoch 79/99
----------
train Loss: 0.4360 Acc: 0.9030
test Loss: 0.5271 Acc: 0.8067

Epoch 80/99
----------
train Loss: 0.4479 Acc: 0.8903
test Loss: 0.5239 Acc: 0.8067

Epoch 81/99
----------
train Loss: 0.4425 Acc: 0.9114
test Loss: 0.5225 Acc: 0.7983

Epoch 82/99
----------
train Loss: 0.4385 Acc: 0.9072
test Loss: 0.5201 Acc: 0.8151

Epoch 83/99
----------
train Loss: 0.4617 Acc: 0.8692
test Loss: 0.5253 Acc: 0.8151

Epoch 84/99
----------
train Loss: 0.4516 Acc: 0.8776
test Loss: 0.5189 Acc: 0.8319

Epoch 85/99
----------
train Loss: 0.4663 Acc: 0.8734
test Loss: 0.5169 Acc: 0.8235

Epoch 86/99
----------
train Loss: 0.4477 Acc: 0.8819
test Loss: 0.5120 Acc: 0.8151

Epoch 87/99
----------
train Loss: 0.4397 Acc: 0.8819
test Loss: 0.5130 Acc: 0.8319

Epoch 88/99
----------
train Loss: 0.4283 Acc: 0.9156
test Loss: 0.5082 Acc: 0.8487

Epoch 89/99
----------
train Loss: 0.4211 Acc: 0.9156
test Loss: 0.5070 Acc: 0.8487

Epoch 90/99
----------
train Loss: 0.4237 Acc: 0.9114
test Loss: 0.5068 Acc: 0.8235

Epoch 91/99
----------
train Loss: 0.4129 Acc: 0.9198
test Loss: 0.5053 Acc: 0.8067

Epoch 92/99
----------
train Loss: 0.4114 Acc: 0.9367
test Loss: 0.5008 Acc: 0.8319

Epoch 93/99
----------
train Loss: 0.4030 Acc: 0.9367
test Loss: 0.4995 Acc: 0.8403

Epoch 94/99
----------
train Loss: 0.4224 Acc: 0.9198
test Loss: 0.4964 Acc: 0.8319

Epoch 95/99
----------
train Loss: 0.3956 Acc: 0.9494
test Loss: 0.4944 Acc: 0.8235

Epoch 96/99
----------
train Loss: 0.4200 Acc: 0.9072
test Loss: 0.4952 Acc: 0.8319

Epoch 97/99
----------
train Loss: 0.3947 Acc: 0.9578
test Loss: 0.4917 Acc: 0.8487

Epoch 98/99
----------
train Loss: 0.4025 Acc: 0.9367
test Loss: 0.4865 Acc: 0.8235

Epoch 99/99
----------
train Loss: 0.4090 Acc: 0.9114
Downloading: "http://data.lip6.fr/cadene/pretrainedmodels/xception-43020ad28.pth" to /home/suresh/.cache/torch/hub/checkpoints/xception-43020ad28.pth
test Loss: 0.4863 Acc: 0.8319

Training complete in 8m 11s
Best val Acc: 0.848739
{'Model': ['resnet18', 'resnet34', 'resnet50', 'resnet101', 'resnet152', 'densenet121', 'densenet161', 'densenet201'], 'ROC_Score': [0.7573529411764706, 0.8088235294117647, 0.7205882352941175, 0.7598039215686276, 0.7475490196078431, 0.7916666666666667, 0.7867647058823529, 0.8161764705882353], 'F1 Score': [0.8137931034482758, 0.8405797101449275, 0.8051948051948052, 0.8111888111888111, 0.8082191780821918, 0.8260869565217391, 0.8309859154929577, 0.863013698630137], 'Recall': [0.8676470588235294, 0.8529411764705882, 0.9117647058823529, 0.8529411764705882, 0.8676470588235294, 0.8382352941176471, 0.8676470588235294, 0.9264705882352942], 'Precision': [0.7662337662337663, 0.8285714285714286, 0.7209302325581395, 0.7733333333333333, 0.7564102564102564, 0.8142857142857143, 0.7972972972972973, 0.8076923076923077], 'Accuracy': [0.773109243697479, 0.8151260504201681, 0.7478991596638656, 0.773109243697479, 0.7647058823529411, 0.7983193277310925, 0.7983193277310925, 0.8319327731092437]}
Traceback (most recent call last):
  File "/usr/lib/python3.10/urllib/request.py", line 1348, in do_open
    h.request(req.get_method(), req.selector, req.data, headers,
  File "/usr/lib/python3.10/http/client.py", line 1283, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1329, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/lib/python3.10/http/client.py", line 1038, in _send_output
    self.send(msg)
  File "/usr/lib/python3.10/http/client.py", line 976, in send
    self.connect()
  File "/usr/lib/python3.10/http/client.py", line 1455, in connect
    self.sock = self._context.wrap_socket(self.sock,
  File "/usr/lib/python3.10/ssl.py", line 513, in wrap_socket
    return self.sslsocket_class._create(
  File "/usr/lib/python3.10/ssl.py", line 1071, in _create
    self.do_handshake()
  File "/usr/lib/python3.10/ssl.py", line 1342, in do_handshake
    self._sslobj.do_handshake()
ssl.SSLCertVerificationError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:1007)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/suresh/maulik/vag/LIK/lik.py", line 431, in <module>
    model_ft = MODELS[i](NB_CLASSES).to(device)
  File "/home/suresh/maulik/vag/LIK/lik.py", line 183, in __init__
    self.net = net_cls(**net_kwards)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/pretrainedmodels/models/xception.py", line 223, in xception
    model.load_state_dict(model_zoo.load_url(settings['url']))
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torch/hub.py", line 746, in load_state_dict_from_url
    download_url_to_file(url, cached_file, hash_prefix, progress=progress)
  File "/home/suresh/maulik/vag/venv/lib/python3.10/site-packages/torch/hub.py", line 611, in download_url_to_file
    u = urlopen(req)
  File "/usr/lib/python3.10/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "/usr/lib/python3.10/urllib/request.py", line 525, in open
    response = meth(req, response)
  File "/usr/lib/python3.10/urllib/request.py", line 634, in http_response
    response = self.parent.error(
  File "/usr/lib/python3.10/urllib/request.py", line 557, in error
    result = self._call_chain(*args)
  File "/usr/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/usr/lib/python3.10/urllib/request.py", line 749, in http_error_302
    return self.parent.open(new, timeout=req.timeout)
  File "/usr/lib/python3.10/urllib/request.py", line 519, in open
    response = self._open(req, data)
  File "/usr/lib/python3.10/urllib/request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "/usr/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/usr/lib/python3.10/urllib/request.py", line 1391, in https_open
    return self.do_open(http.client.HTTPSConnection, req,
  File "/usr/lib/python3.10/urllib/request.py", line 1351, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:1007)>
